
// ==UserScript==
// @name           Moswar assistant
// @author         barifan
// @namespace      акулы
// @version        4.20
// @description    лучшатора для мосвара
// @include        https://*.moswar.ru*
// @include        https://*.moswar.net*
// @include        https://*.moswar.mail.ru*
// @match          https://www.moswar.ru/*
// @match          https://*.moswar.net/*
// @updateURL      https://raw.githubusercontent.com/boris-chb/moswar-extension/refs/heads/main/dist/bundle.js
// @downloadURL    https://raw.githubusercontent.com/boris-chb/moswar-extension/refs/heads/main/dist/bundle.js
// @grant          none
// ==/UserScript==
(async function () {

var utils_=(()=>{var _e=Object.defineProperty;var Et=Object.getOwnPropertyDescriptor;var Dt=Object.getOwnPropertyNames;var Ht=Object.prototype.hasOwnProperty;var Gt=(e,t)=>{for(var n in t)_e(e,n,{get:t[n],enumerable:!0})},zt=(e,t,n,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of Dt(t))!Ht.call(e,r)&&r!==n&&_e(e,r,{get:()=>t[r],enumerable:!(o=Et(t,r))||o.enumerable});return e};var Xt=e=>zt(_e({},"__esModule",{value:!0}),e);var to={};Gt(to,{BANNED_CARS_RIDES_IDS:()=>Se,DOPINGS_DATA_ST:()=>ve,EXCEPTION_CARS:()=>ne,EXCEPTION_PLANES_AND_BOATS_RIDES_IDS:()=>it,HEADERS:()=>et,PLANES_AND_BOATS_RIDES_IDS:()=>J,aIsGroupFight:()=>Me,attackByCriteria:()=>Q,attackOrReschedule:()=>Ut,attackPlayer:()=>Ze,attackRandom:()=>ln,autoPilot:()=>Qn,boostClan:()=>Re,buyCasinoTokens:()=>Yn,carBringup:()=>rt,carBringupMode:()=>H,chaoticFightMode:()=>Ee,checkBronikPieces:()=>V,checkBubble:()=>Lt,checkCarTank:()=>Ce,checkInjury:()=>Ye,checkVictimWorthy:()=>Ft,convertPlayerUrlToId:()=>Te,createButton:()=>_,createPopover:()=>Y,delay:()=>O,drawTimers:()=>tt,dungeonSpeedUp:()=>ue,eatSilly:()=>Be,eatSnickers:()=>be,farm:()=>Oe,farmEnemies:()=>$e,farmVictims:()=>We,fightMode:()=>Ke,fillCarTank:()=>pe,filterLogs:()=>Wt,formatNumber:()=>ee,formatTime:()=>S,fuelAllCars:()=>Zt,gatherStats:()=>Jt,getAlleyCooldown:()=>W,getElementsOnThePage:()=>w,getGarageRides:()=>Ae,getMoscowTime:()=>K,getPlayerId:()=>te,getStats:()=>Ne,getTodayScore:()=>Kt,handlePvpFight:()=>P,handleSmurfFight:()=>Ve,handleUI:()=>ye,heal:()=>At,init:()=>eo,joinBankRobbery:()=>In,joinChaoticFight:()=>Je,joinDeps:()=>Pt,joinGypsy:()=>En,joinPahan:()=>He,joinProt:()=>Fe,joinSiri:()=>qt,kubovichSpeedUp:()=>fe,makeTurn:()=>Ue,mapDataStToDataId:()=>ze,metroWorkMode:()=>ie,neftLeninSpeedUp:()=>ge,parseHtml:()=>B,patrolMode:()=>D,playGypsy:()=>me,player:()=>Nt,protMode:()=>cn,redrawMain:()=>he,renderCandyCountdown:()=>we,renderNavbar:()=>Ie,renderPanel:()=>Pe,resetAlleyCooldown:()=>On,restoreHP:()=>F,scrapeStat:()=>ot,sendAlert:()=>A,sendCars:()=>st,sendMessage:()=>lt,sendPlanesAndBoats:()=>at,sendRide:()=>je,shouldAttack:()=>Bn,showAlert:()=>Qe,signUpForDeps:()=>De,signUpForSiri:()=>xe,smurfInit:()=>Ot,sortGarage:()=>Le,startPatrol:()=>Ct,strToHtml:()=>q,takeDailyDose:()=>Pn,timeToMs:()=>Vt,trackAndAttackRat:()=>Rt,trackRatMode:()=>N,tradeAllSiri:()=>Ge,undressItem:()=>Zn,useDopings:()=>Xe,useItem:()=>re,waitForCooldown:()=>ke,watchTv:()=>Mn,workMode:()=>X,zodiacMode:()=>se});async function nt(){let n=(await(await fetch(new URL(window.location.href).origin+"/casino/blackjack/",{method:"POST",headers:{accept:"application/json, text/javascript, */*; q=0.01","content-type":"application/x-www-form-urlencoded; charset=UTF-8","x-requested-with":"XMLHttpRequest"},body:"action=new&bet=10",credentials:"include"})).json()).newRightHand.reduce((o,r)=>o+r[2],0);for(;n<17;){await new Promise(a=>setTimeout(a,500));let r=await(await fetch(new URL(window.location.href).origin+"/casino/blackjack/",{method:"POST",headers:{accept:"application/json, text/javascript, */*; q=0.01","content-type":"application/x-www-form-urlencoded; charset=UTF-8","x-requested-with":"XMLHttpRequest"},body:"action=more",credentials:"include"})).json();if(!r.card||(n+=r.card[0][2],n>21))break}await new Promise(o=>setTimeout(o,500)),await fetch(new URL(window.location.href).origin+"/casino/blackjack/",{method:"POST",headers:{accept:"application/json, text/javascript, */*; q=0.01","content-type":"application/x-www-form-urlencoded; charset=UTF-8","x-requested-with":"XMLHttpRequest"},body:"action=stop",credentials:"include"})}var ce=window.$;function Vt(e){let t=e.split(":").map(Number),n=0,o=0,r=0;return t.length===3?(n=t[0],o=t[1],r=t[2]):t.length===2?(o=t[0],r=t[1]):t.length===1&&(r=t[0]),(n*3600+o*60+r)*1e3}function K(){return new Date(new Date().toLocaleString("en-US",{timeZone:"Europe/Moscow"}))}function S(e){let t=Math.floor(e/3600),n=Math.floor(e%3600/60),o=e%60;return[t>0?String(t).padStart(2,"0"):null,String(n).padStart(2,"0"),String(o).padStart(2,"0")].filter(Boolean).join(":")}function ee(e){return e=`${e}`.split(",").join(""),Math.abs(e)>=1e9?Math.floor(e/1e9*10)/10+"B":Math.abs(e)>=1e6?Math.floor(e/1e6*10)/10+"M":Math.abs(e)>=1e3?Math.floor(e/1e3*10)/10+"K":e.toString()}function O(e=1){return new Promise(t=>setTimeout(t,e*1e3))}async function w(e,t){let n=new URL(window.location.href).origin,o=t.startsWith("/")?t:"/"+t,a=await(await fetch(n+o)).text(),c=B(a).querySelectorAll(e);if(c.length!==0)return c.length===1?c[0]:Array.from(c)}function B(e){let t=new DOMParser,n=e.replace(/\\&quot;/g,'"').replace(/\\"/g,'"');return t.parseFromString(n,"text/html")}function Te(e){let t=e.match(/\player\/(\d+)\//);return t?t[1]:null}function te(e){try{let t=e.querySelector(".fighter2 .user a").href;return Te(t)}catch{console.log("\u{1F6A7} Could not find player id")}}function Wt(e=window.document){return[...e.querySelectorAll("tr")].filter(r=>r.querySelector("td.actions div.c")?.innerText==="\u0412 \u0441\u043F\u0438\u0441\u043E\u043A \u0436\u0435\u0440\u0442\u0432").map(r=>{let a=+r.querySelector(".text .tugriki").innerText.split(",").join(""),s=r.querySelector(".user a").href;if(a>3e5)return s}).filter(r=>r).map(r=>Te(r))}async function Kt(){return+(await w(".my .value b","/rating/wins/")).innerText}function q(e){let t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild}async function ot(e){let t=`#stats-accordion > dd:nth-child(2) > ul > li:nth-child(${e}) > div.label > span`;ce(`${t}`).trigger("mouseenter"),await new Promise(x=>setTimeout(x,250));let o=`#tooltip${e+1}`,r=`${o} > h2`,a=ce(r)[0]?.innerText;if(!a)return console.error(`Key not found for tooltip ${o}`),null;let s=`${o} > div > span:nth-child(1)`,c=ce(s)[0]?.innerText||"",l=parseInt(c.split(":")[1].trim(),10),d=`${o} > div > span:nth-child(3)`,p=ce(d)[0]?.innerText||"",h=parseInt(p.split("+")[1].trim(),10);return{[a]:{\u041F\u0435\u0440\u0441\u043E\u043D\u0430\u0436:l||0,["\u0421\u0443\u043F\u0435\u0440"+a.toLowerCase()]:h||0,\u0421\u0443\u043C\u043C\u0430:(l||0)+(h||0)}}}async function Jt(){let e={\u0414\u0430\u0442\u0430:new Date().toLocaleDateString("ru-RU").replace(/\./g,"/")};for(let t=1;t<=7;t++){let n=await ot(t);n&&Object.assign(e,n)}return e}function _({text:e,onClick:t=async()=>{},title:n,className:o,disableAfterClick:r=!0,special:a=!1}){let s=q(`<button type="button" class="${o?o+"-btn":""} ${a?"autopilot-action":"button"}"><span style="float: none;" class="f"><i class="rl"></i><i class="bl"></i><i class="brc"></i><div class="c">${e}</div></span></button>`);return s.setText=function(c){$(s).find(".c").text(c)},s.addEventListener("click",async c=>{if(!s.classList.contains("disabled")){s.classList.add("disabled");try{await t(c)}catch(l){console.error(t.toString(),l)}r||s.classList.remove("disabled")}}),n&&(s.title=n),a&&$(s).css({border:"2px solid #3048a5",fontSize:"10px",minWidth:"120px",lineHeight:"18px"}),simple_tooltip($(s)),s}function E({label:e,action:t,className:n,min:o=0,max:r=500}){let a=$(`<div class="${n} btn-input-field"></div>`).css({display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",padding:"4px"}),s=$("<input>",{type:"number",min:o,max:r,value:o,class:"input-field"}).css({width:"60px",textAlign:"center"}).on("input",function(){let l=parseInt($(this).val(),10);l||$(this).val(o),l>r&&$(this).val(r),l<o&&$(this).val(o),c.setText(`${e} x${$(this).val()}`)}),c=_({text:`${e} x${o}`,className:n,onClick:async()=>{let l=parseInt(s.val(),10);if(isNaN(l)||l<=o||l>r)return;c.classList.add("disabled");let d=Date.now();for(let f=0;f<l;f++)await t();let h=Date.now()-d;c.classList.remove("disabled")}});return a.append(s,$(c)),a}var ne=[160,198,64,48,165,46,167,40,211,221,197,50,122,215,47,110,115,220,196,133,87,222,179,161],it=[158,219,155,121],J=[158,121,219,155,192,190,223,93,97,135,182,178,195,59,216,212,183,173,159,156,149,146,134,119,111,95,88,84,78,74,69,68,65,58,55,54,52,51,49,44,38,36,35],Se=[141,19,85,174,175,176,166,177,61,187,188,33],Yt=[{name:"\u{1F699} \u0422\u0430\u0447\u043A\u0438 6 \u0447.",rides:[1,2,3,4,5,6,86,162,42]},{name:"\u{1F3CE}\uFE0F \u0422\u0430\u0447\u043A\u0438 10-12 \u0447.",rides:[7,8,9,10,11,12,45,50,80,83,98,163,164,191,213,214,222,110,197,92,96,221]},{name:"\u{1F699} \u0422\u0430\u0447\u043A\u0438 13-15 \u0447.",rides:[215,47,53,43,169,70,157,57,62,145,170]},{name:"\u{1F697} \u0412\u0421\u0415 \u0422\u0410\u0427\u041A\u0418! \u{1F4AF}",rides:[]}];async function rt(e="979786"){await Ce(e),fetch(new URL(window.location.href).origin+"/automobile/bringup/",{headers:{accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/automobile/bringup/",referrerPolicy:"strict-origin-when-cross-origin",body:`car=${e}&__ajax=1&return_url=%2Farbat%2F`,method:"POST",mode:"cors",credentials:"include"})}async function H(e="979786"){if(!(new Intl.DateTimeFormat("en-US",{weekday:"long",timeZone:"Europe/Moscow"}).format(new Date)==="Monday")){showAlert("\u{1F695}","\u041D\u0435 \u043F\u043E\u043D\u0435\u0434\u0435\u043B\u044C\u043D\u0438\u043A.");return}let n=await w("#cooldown","/arbat/");if(n)try{let a=await n.getAttribute("timer");console.log(`[\u{1F695}] Retrying in ${S(a)} minutes.`),setTimeout(()=>H(e),+a*1e3);return}catch{console.log("[\u{1F695}] Cooldown timer not found.")}await rt(e),await O(3);let r=await(await w("#cooldown","/arbat/")).getAttribute("timer");console.log(`[\u{1F695}] \u2705 Done. Retrying in ${S(r)} minutes.`),setTimeout(()=>H(e),+r*1e3)}async function pe(e="1095154"){await fetch(`${new URL(window.location.href).origin}/automobile/buypetrol/${e}/`,{headers:{accept:"*/*","accept-language":"en-GB,en;q=0.9","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-ch-ua":'"Chromium";v="131", "Not_A Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:`${new URL(window.location.href).origin}/automobile/buypetrol/${e}/`,referrerPolicy:"strict-origin-when-cross-origin",body:`__ajax=1&return_url=%2Fautomobile%2Fcar%2F${e}`,method:"POST",mode:"cors",credentials:"include"})}async function Zt(){try{let t=(await w("#home-garage > div > div > a","/home/")).map(n=>n.getAttribute("href").split("/").splice(-2,1)[0]);await Promise.all(t.map(n=>pe(n)))}catch{console.log("Could not fuel all cars")}}function Ae(){return[...document.querySelectorAll("li")].filter(e=>e.getAttribute("id")&&!e.querySelector("span.timeout")).map(e=>{let t=+e.querySelector('.actions input[name="car"]').getAttribute("value"),n=+e.querySelector('.actions input[name="direction"]').getAttribute("value");return{carId:t,rideId:n}})}async function je(e,t){await Ce(e);let o=await(await fetch(new URL(window.location.href).origin+"/automobile/ride/",{body:new URLSearchParams({direction:t,car:e,__ajax:"1"}),method:"POST",mode:"cors",credentials:"include"})).text(),a=B(o).querySelector("body > .alert");a.style.display="block",a.style.position="static",a.style.margin="5px",a.querySelector(".close-cross").remove();let s=$("#ride-alerts");s.length<1&&(s=Y("ride-alerts")),s.css({"align-items":"flex-start",overflowY:"scroll",maxHeight:"65vh",width:"90vw"}),s.append(a)}async function at(){let t=Ae().filter(n=>J.includes(n.rideId)&&!it.includes(n.rideId));if(!t||t.length===0){A({title:"\u041E\u0448\u0438\u0431\u043A\u0430!",img:"/@/images/loc/auto/trip34.jpg",text:"\u041D\u0435 \u043D\u0430\u0448\u043B\u043E\u0441\u044C \u0412\u0412 \u0434\u043B\u044F \u043E\u0442\u043F\u0440\u0430\u0432\u043A\u0438."});return}for(let n of t)await je(n.carId,n.rideId);A({title:"\u0412\u0441\u0435 \u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u043E \u0441\u0434\u0435\u043B\u0430\u043B!",img:"/@/images/loc/auto/trip22.jpg",text:`\u041E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u043E \u0412\u0412: ${t.length} \u2708\uFE0F\u{1F6A2}.`})}async function st(e=[]){let n=Ae().filter(({rideId:o,carId:r})=>!J.includes(o)&&!ne.includes(r)&&!Se.includes(r)&&(e.length===0||e.includes(o)));if(!n||n.length===0){A({title:"\u041E\u0448\u0438\u0431\u043A\u0430!",img:"/@/images/loc/auto/trip34.jpg",text:"\u041D\u0435 \u043D\u0430\u0448\u043B\u043E\u0441\u044C \u0442\u0430\u0447\u0435\u043A \u0434\u043B\u044F \u043E\u0442\u043F\u0440\u0430\u0432\u043A\u0438."});return}for(let o of n)await je(o.carId,o.rideId);A({title:"\u0412\u0441\u0435 \u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u043E \u0441\u0434\u0435\u043B\u0430\u043B!",img:"/@/images/loc/auto/trip22.jpg",text:`\u041E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u043E \u0442\u0430\u0447\u0435\u043A: ${n.length} \u{1F699}.`})}async function Ce(e="979786"){let t=await w(".fuel .neft",`/automobile/car/${e}/`);try{+t.innerText.split(":")[1].split("/")[0]===0&&(console.log("[Check Car Tank] Car tank is empty!"),await pe(e))}catch{console.log("[Check Car Tank] Car tank not found")}}function Le(){if($("#send-cars-controls").length>0)return;let e=_({text:"\u{1F6A2} \u2708\uFE0F \u041E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u044C \u0432\u0432",onClick:at,special:!0,disableAfterClick:!1}),t=Yt.map(s=>_({text:s.name,onClick:async()=>{confirm(`\u041E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u044C ${s.name}?`)&&await st(s.rides)},disableAfterClick:!1,special:!0})),n=$("#content > div > div.cars-trip-choose.clearfix > div ul li");n.each(function(){let s=$(this).data("direction-id");if(s){let l=$("<span>").text(s).css({position:"absolute",color:"whitesmoke",right:"3%",zIndex:10,background:"black",borderRadius:"4px",padding:"2px"});$(this).prepend(l)}$(this).find(".ride-button").on("click",async function(l){l.preventDefault();let d=$(this).closest("li").find("input.car-id").val();await pe(d),$(this).closest("form").submit()})});function o(s){let{exceptionCars:c,planesAndBoats:l,rest:d,bannedCars:p}=en(s),h=[...c,...d,...p],f=[...c,...l,...Qt(d.reverse()),...p],x=l.filter(g=>le($(g))>0).length,k=h.filter(g=>{let[b,T]=[64,198],U=+$(g).attr("data-direction-id");return U===b||U===T?!1:le($(g))>0}).length,L=$(`
      <div id="cars-count">
        <span>\u041E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u043E \u0432\u0432: <b>${x} /  ${l.length}</b> \u2708\uFE0F \u{1F6A2}</span>
        <span>\u2022</span>
        <span>\u041E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u043E \u0442\u0430\u0447\u0435\u043A: <b>${k} / ${h.length}</b> \u{1F699}</span>
      </div>
    `).css({display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",gap:"16px",fontSize:"18px",lineHeight:"16px",textTransform:"uppercase",fontFamily:"bloccregular",padding:"12px 0px"}),R=$("<div id='send-cars-buttons'></div>").css({display:"flex",flexWrap:"wrap",justifyContent:"center",gap:"8px",width:"80%"}).append(e).append(t);R.children().css({flex:"1 0 30%",maxWidth:"30%"});let y=$("<div id='send-cars-controls'>").css({display:"flex",flexDirection:"column",gap:"8px",justifyContent:"center",alignItems:"center"}).append(R).append(L);$("#content > div > div.block-bordered").html(y);let j=$("#content > div > div.cars-trip-choose.clearfix > div ul");$(f).appendTo(j)}function r(s){s.each((c,l)=>{$(l).find("table.title").remove(),$(l).find("table.ride-info").remove(),$(l).css({minHeight:"auto",height:"auto"}),$(l).find(".picture .timeout").each((d,p)=>{$(p).css({height:"auto"}),$(p).contents().not("span.ride-cooldown").remove()}),$(l).find(".car .timeout").length&&$(l).css("opacity",.7)})}o(n),r(n);let a=$("#content > div > div.cars-trip-choose.clearfix > div ul");n.css("box-shadow","0px 1px 9px 2px rgba(24, 22, 38, 0.5)"),a.css({display:"grid","grid-template-columns":"repeat(auto-fit, minmax(200px, 1fr))",gap:"10px"}),$(".cars-trip-choose.clearfix").css({position:"relative",left:"35%",transform:"translateX(-50%)",width:"80vw",margin:"auto","z-index":101}),$(".cars-trip-accordion").css({background:"rgba(255, 255, 255, 0.2)","backdrop-filter":"blur(10px)","-webkit-backdrop-filter":"blur(10px)","border-radius":"10px",border:"1px solid rgba(255, 255, 255, 0.3)",padding:"20px",width:"100%","box-shadow":"0 4px 10px rgba(0, 0, 0, 0.1)"})}function le(e){let t=e.find(".car .car-cooldown").attr("timer");return t?parseInt(t,10):-1}function Qt(e){return Array.isArray(e)||(e=e.toArray()),e.sort((t,n)=>le($(n))-le($(t)))}function en(e){let t=[],n=[],o=[],r=[];return e.each((a,s)=>{let c=$(s),l=+c.attr("data-direction-id");ne.includes(l)?t.push(s):J.includes(l)?(c.css("background","#aad7f8"),n.push(s)):Se.includes(l)?(c.css("background","#b9060e"),r.push(s)):o.push(s);function d(p,h){let f=h.indexOf(p);return f===-1?1/0:f}return t.sort((p,h)=>{let f=+$(p).attr("data-direction-id"),x=+$(h).attr("data-direction-id");return d(f,ne)-d(x,ne)}),n.sort((p,h)=>{let f=+$(p).attr("data-direction-id"),x=+$(h).attr("data-direction-id");return d(f,J)-d(x,J)}),[...t,...n,...o]}),{exceptionCars:t,planesAndBoats:n,rest:o,bannedCars:r}}async function de(e,t="victim"){await fetch(new URL(window.location.href).origin+"/phone/contacts/add/",{headers:{accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-ch-ua":'"Chromium";v="131", "Not_A Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/phone/contacts/add/",referrerPolicy:"strict-origin-when-cross-origin",body:`name=+${e}&clan=&info=&type=${t}&__ajax=1&return_url=%2Fphone%2Fcontacts%2Fadd%2F7178077%2F`,method:"POST",mode:"cors",credentials:"include"})}async function ct(e,t){console.log(`\u{1F525} Removing ${e} from contacts.`),await fetch(new URL(window.location.href).origin+"/phone/contacts/",{headers:{accept:"*/*","accept-language":"en-GB,en;q=0.9","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-ch-ua":'"Chromium";v="131", "Not_A Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/phone/contacts/victims/",referrerPolicy:"strict-origin-when-cross-origin",body:`action=delete&id=${t}&nickname=+${e}&type=contact&__referrer=%2Fphone%2Fcontacts%2Fvictims%2F&return_url=%2Fphone%2Fcontacts%2Fvictims%2F`,method:"POST",mode:"cors",credentials:"include"})}async function lt(e,t){try{let n=(await w('input[name="post_key"]',new URL(window.location.href).origin+"/phone/")).value;await fetch(new URL(window.location.href).origin+"/phone/messages/send/",{headers:{accept:"*/*","accept-language":"en-GB,en;q=0.9","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-ch-ua":'"Chromium";v="131", "Not_A Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/phone/messages/send/",referrerPolicy:"strict-origin-when-cross-origin",body:`maxTextSize=10000&post_key=${n}&name=${e}&text=${t}&__ajax=1&return_url=%2Fphone%2F`,method:"POST",mode:"cors",credentials:"include"}),showAlert("Phone \u2705",`Message sent to ${e}`)}catch{showAlert("Phone \u274C","Could not send message"),console.log("Could not send message")}}async function pt(){await fetch("https://www.moswar.ru/phone/clear-contacts/enemies/",{headers:{accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-ch-ua":'"Chromium";v="137", "Not/A)Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:"https://www.moswar.ru/phone/clear-contacts/enemies/",referrerPolicy:"strict-origin-when-cross-origin",body:"__ajax=1&return_url=%2Fphone%2Fcontacts%2Fenemies%2F",method:"POST",mode:"cors",credentials:"include"})}async function tn(){let e=$("#players .user").toArray();for(let t of e){let n=$(t),o=n.find('a[href*="/player/"]').attr("href")?.split("/")[2];if(!o)continue;let r=await w("#pers-player-info .cool-1",`/player/${o}/`);if(!r||!r[0])continue;let a=$(r[0]).clone(),s=a.find("span.cool-1"),c=parseInt(s.text().replace(/\D/g,""),10);if(isNaN(c))continue;let l=ee(c);s.attr("title",c),s.text(l),n.append(a)}}async function dt(){await tn();let e=[];$("#players .user").each(function(){let n=parseInt($(this).find("span.cool-1").last().attr("title"),10);isNaN(n)||e.push({element:$(this),coolness:n})}),e.sort((n,o)=>o.coolness-n.coolness);let t=$("#players").empty();e.forEach(n=>t.append(n.element,"<br>"))}async function ut(){await pt();let e=$('#players .user a[href^="/player/"]').map((t,n)=>$(n).text().trim()).get();for(let t of e)await de(t,"enemy");A({title:"\u0412\u0441\u0451 \u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u043E \u0441\u0434\u0435\u043B\u0430\u043B!",img:"/@/images/pers/man102_thumb.png",text:"\u0414\u043E\u0431\u0430\u0432\u0438\u043B \u0432\u0441\u0435\u0445 \u0438\u0433\u0440\u043E\u043A\u043E\u0432 \u0432 \u043A\u043E\u043D\u0442\u0430\u043A\u0442\u044B (\u0432\u0440\u0430\u0433\u0438)."})}async function ft(e){if(!e){console.log("\u{1F48E} No count provided for emerald payment.");return}await fetch(new URL(window.location.href).origin+"/clanbeast/",{headers:{accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-ch-ua":'"Chromium";v="137", "Not/A)Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:"https://www.moswar.ru/clanbeast/",referrerPolicy:"strict-origin-when-cross-origin",body:`action=pay_emerald&amount=${e}&ajax=1&__referrer=%2Fclanbeast%2F&return_url=%2Fclanbeast%2F`,method:"POST",mode:"cors",credentials:"include"})}var G={roar:-310,topot:-311,krovotok:-313,secondSelf:363,vampirism:540,invincible:541,mass:543};async function P(){if(AngryAjax.getCurrentUrl().includes("fight")){if(!$(".block-rounded").children().first().hasClass("current")){showAlert("\u041E\u0448\u0438\u0431\u043A\u0430","\u041F\u0435\u0440\u0435\u0439\u0434\u0438\u0442\u0435 \u043D\u0430 \u043F\u043E\u0441\u043B\u0435\u0434\u043D\u0438\u0439 \u0445\u043E\u0434!");return}if($("#fightGroupForm > table > tbody > tr > td.log > ul > li:nth-child(1) > div.result").length>0){showAlert("\u041E\u0448\u0438\u0431\u043A\u0430","\u0411\u043E\u0439 \u0443\u0436\u0435 \u0437\u0430\u043A\u043E\u043D\u0447\u0435\u043D.");return}console.info("\u0421\u043A\u0438\u043F \u0431\u043E\u044F"),await z(G.roar),await z(G.secondSelf),await z(G.krovotok),await z(G.vampirism),await z(G.topot),await z(G.mass),await z(G.invincible),await Ue(1)}}async function z(e){await fetch(new URL(window.location.href).origin+"/fight/",{headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8"},body:`action=useabl&json=1&target=${e}`,method:"POST",credentials:"include"})}async function nn(){console.log("[PVP] START FIGHT..."),await fetch(new URL(window.location.href).origin+"/travel2/",{headers:{accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/travel2/",referrerPolicy:"strict-origin-when-cross-origin",body:"action=fight",method:"POST",mode:"cors",credentials:"include"}),AngryAjax.reload()}async function on(e=!1){let n=await(await fetch(new URL(window.location.href).origin+"/travel2/",{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","accept-language":"en-US,en;q=0.9,ru;q=0.8","cache-control":"max-age=0","content-type":"application/x-www-form-urlencoded","upgrade-insecure-requests":"1"},referrer:new URL(window.location.href).origin+"/travel2/",referrerPolicy:"strict-origin-when-cross-origin",body:`action=roll${e?"2":""}&ajax=1&__referrer=%2Ftravel2%2F&return_url=%2Ftravel2%2F`,method:"POST",mode:"cors",credentials:"include"})).text(),o=B(n),r=$(o).find(".worldtour-stats"),a=$(o).find(".worldtour__team.worldtour__team--right"),s=$(o).find(".worldtour__footer-reward");s.length&&$(".worldtour__footer-reward").first().replaceWith(s),$(".worldtour-stats").replaceWith(r),$(".worldtour__team.worldtour__team--right").replaceWith(a),console.log(a.children().first()),simple_tooltip(a.children().first()),mt()}function gt(){if($("#pvp-totals").length)return;let e={current:0,max:0};$("#travel-2-country option").each(function(){let n=$(this).text().match(/(\d+)\/(\d+)/);n&&(e.current+=Number(n[1]),e.max+=Number(n[2]))});let t=$(`<span id="pvp-totals" style="font-size:140%" class="dpoints">
    <br>${e.current} / ${e.max}<i></i>
    </span>`);$(".worldtour-stats__content").css({background:"#00034a"}).append(t),$("span.dpoints").css({"text-shadow":"1px 1px 1px #00000073"})}function rn(){if(Worldtour2.step===Worldtour2.maxStep)return;let e=[...$("#slava_info").text().matchAll(/сейчас ты получаешь лишь\s+([\d.]+%)/g)].pop()?.[1],t=$(".worldtour-stats__p").first().text(),n=parseInt(t.match(/лучший результат.*?(\d+)\s+славы/)?.[1]),o=$(".worldtour-stats__p").first().next().text(),r=parseInt(o.match(/можете получить до\s+(\d+)\s+славы/)?.[1]),a=parseInt(o.match(/максимум.*?(\d+)/)?.[1]);$(".worldtour-stats__content .worldtour-stats__p").each((c,l)=>$(l).remove());let s=$("<div>").addClass("worldtour-stats__p").css({display:"flex",gap:"4px",alignItems:"center",justifyContent:"center",textShadow:"none",fontSize:"120%"}).append("\u0421\u0435\u0439\u0447\u0430\u0441:").append($("<span>").addClass("dpoints").text(n).append("<i></i>")).append("\u041C\u043E\u0436\u0435\u0442\u0435 \u043F\u043E\u043B\u0443\u0447\u0438\u0442\u044C:").append($("<span>").addClass("dpoints").text(r).append("<i></i>")).append(`\u041C\u0430\u043A\u0441\u0438\u043C\u0443\u043C (${e}):`).append($("<span>").addClass("dpoints").text(a).append("<i></i>"));$(".worldtour-stats__content").append(s),$(".worldtour__map-wrapper").css({height:"350px"})}function mt(){$("#content > div.worldtour.worldtour--2.worldtour--atlantida > div.worldtour__footer > div.worldtour__footer-actions-2 button").each((e,t)=>{$(t).off("click").removeAttr("onclick").on("click",async()=>{await on(e===1),gt()})}),$(".worldtour__button-border-blue .worldtour__button-small").on("click",ht)}function ht(){let e=$(".worldtour-helpers-inner");e.html(e.children().slice(0,10)),e.css({width:"auto","margin-left":"0%",display:"flex","flex-direction":"column",height:"100%"}),$(".worldtour__pagination").remove()}function an(){$("#travel-2-country option").each(function(){let e=$(this).text(),t=e.match(/(\d+)\/(\d+)/);if(!t)return;let n=parseInt(t[1],10),o=parseInt(t[2],10);e=e.replace(/[✔?]/,n===o?"\u2705":"\u23F3"),$(this).text(e)})}function wt(){if($("#skip-fight-btn").length)return;if(mt(),ht(),gt(),an(),rn(),$(".worldtour-rating-place").css({position:"absolute"}),$(".worldtour-banner").appendTo($(".worldtour-banner").parent()),$(".auto-pvp").length>0){console.log("[PVP] Panel already initialized.");return}let e=$('<div class="button auto-pvp" id="skip-fight-btn" class="auto-pvp"><a class="f" ><i class="rl"></i><i class="bl"></i><i class="brc"></i><div class="c"><span>\u23E9 \u0421\u043A\u0438\u043F \u0431\u043E\u044F</span></div></a></div>'),t=$('<div class="disabled button auto-pvp" id="skip-fight-btn" class="auto-pvp"><a class="f"><i class="rl"></i><i class="bl"></i><i class="brc"></i><div class="c"><span>\u221E \u0411\u0435\u0441\u043A\u043E\u043D\u0435\u0447\u043D\u044B\u0439 \u0431\u043E\u0439</span></div></a></div>');async function n(){$(document).one("ajaxStop",()=>{AngryAjax.reload(),setTimeout(()=>P(),500)}),await nn()}function o(){showAlert("\u041E\u0448\u0438\u0431\u043A\u0430","\u0415\u0449\u0435 \u043D\u0435 \u0433\u043E\u0442\u043E\u0432\u043E")}e.on("click",n),t.on("click",o),$("#travel-classic-button").after(t),$("#travel-pvp-button").after(e)}var u={};u.newstart=!0;u.appzone=1;u.nextzone=0;u.ss={1:{zona:3,goboss:2,goper:[2,0,2],flapt:0,flboss:"",fluseapt:20},2:{zona:3,goboss:13,goper:[3,0,13],flapt:0,flboss:"",fluseapt:20},3:{zona:2,goboss:4,goper:[4,0,2],flapt:0,flboss:"",fluseapt:20},4:{zona:2,goboss:5,goper:[5,0,3],flapt:0,flboss:"",fluseapt:20},5:{zona:2,goboss:6,goper:[6,0,4],flapt:0,flboss:"",fluseapt:20},6:{zona:2,goboss:7,goper:[7,0,5],flapt:0,flboss:"",fluseapt:30},7:{zona:2,goboss:8,goper:[8,0,6],flapt:0,flboss:"",fluseapt:99},8:{zona:2,goboss:9,goper:[11,0,7],flapt:0,flboss:"",fluseapt:99},9:{zona:2,goboss:10,goper:[8,0,8],flapt:0,flboss:"",fluseapt:99},10:{zona:2,goboss:0,goper:[9,0,9],flapt:0,flboss:"boss",fluseapt:99},11:{zona:1,goboss:12,goper:[0,0,8],flapt:0,flboss:"",fluseapt:30},12:{zona:1,goboss:0,goper:[0,0,11],flapt:0,flboss:"box",fluseapt:0},13:{zona:3,goboss:14,goper:[2,0,14],flapt:0,flboss:"",fluseapt:20},14:{zona:3,goboss:15,goper:[13,0,16],flapt:0,flboss:"",fluseapt:20},15:{zona:3,goboss:17,goper:[14,0,14],flapt:0,flboss:"",fluseapt:20},16:{zona:4,goboss:23,goper:[14,0,23],flapt:0,flboss:"",fluseapt:20},17:{zona:3,goboss:21,goper:[15,0,15],flapt:0,flboss:"",fluseapt:20},18:{zona:4,goboss:0,goper:[23,0,23],flapt:0,flboss:"box",fluseapt:70},19:{zona:5,goboss:20,goper:[23,0,0],flapt:0,flboss:"",fluseapt:20},20:{zona:5,goboss:0,goper:[19,0,0],flapt:0,flboss:"",fluseapt:20},21:{zona:3,goboss:22,goper:[17,0,17],flapt:0,flboss:"",fluseapt:0},22:{zona:3,goboss:0,goper:[21,0,21],flapt:0,flboss:"boss",fluseapt:99},23:{zona:4,goboss:18,goper:[16,0,19],flapt:0,flboss:"",fluseapt:70}};u.zona={1:{boss:12},2:{boss:10},3:{boss:22},4:{boss:18},5:{boss:20}};u.obj={12:!0,10:!0,22:!0,18:!0};u.apt={};u.empty=function(){for(var e in u.dungObj.rooms)if(!u.dungObj.rooms[e].passed&&u.ss[e].zona!=5)return!1;return!0};u.theend=function(){AngryAjax.reload(),showAlert("\u0412\u0441\u0435 \u043F\u0440\u043E\u0439\u0434\u0435\u043D\u043E","\u041C\u043E\u0436\u0435\u0442\u0435 \u0432\u044B\u0439\u0442\u0438 \u0438\u0437 \u043F\u043E\u0434\u0437\u0435\u043C\u043A\u0438.")};u.xod=function(){var e,t;$.get("/dungeon/inside/",function(n){if(response=n.content,n&&n.return_url&&n.return_url=="/dungeon/"){showAlert("\u041D\u0435 \u0441\u043F\u0443\u0441\u0442\u0438\u043B\u0438\u0441\u044C","\u0421\u043F\u0443\u0441\u0442\u0438\u0442\u0435\u0441\u044C \u0432 \u043E\u0434\u0438\u043D\u043E\u0447\u043D\u0443\u044E \u043F\u043E\u0434\u0437\u0435\u043C\u043A\u0443 \u0441\u043F\u0435\u0440\u0432\u0430."),setTimeout(u.xod,5e3);return}if(n&&n.return_url&&n.return_url.search("/fight/")!=-1){$(document).one("ajaxStop",P),console.log("\u0413\u0440\u0443\u043F\u043F\u043E\u0432\u043E\u0439 \u0431\u043E\u0439 "),setTimeout(u.xod,5e3);return}u.dungObj=$.parseJSON(n.content.match(/var json = ({[\s\S]*});/m)[1]),console.log(u.dungObj);var o=Number(u.dungObj.room_players[player.id].position);if(u.newstart){console.log("\u0438\u043D\u0438\u0446\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044F..."),u.newstart=!1;for(t in u.obj)u.ss[t].flboss=="boss"&&(u.dungObj.objects[t]&&u.dungObj.objects[t].length!=0?u.obj[t]=!0:u.obj[t]=!1)}console.log("\u043A\u043B\u0435\u0442\u043A\u0430 "+o);var r=u.ss[o].zona,a=u.zona[r].boss,s=u.ss[o].flapt;if(u.ss[o].flboss&&u.obj[o]){console.log("\u044E\u0437\u0430\u0435\u043C \u043E\u0431\u044A\u0435\u043A\u0442 \u0432 "+o),postUrl("/dungeon/useobject/",{action:"useobject",room:o,object:0},"post",function(c){c.result&&(u.obj[o]=!1),u.xod()},"json");return}if(u.empty()){u.theend();return}s>0&&u.apt[s]?(e=s,console.log("\u0438\u0434\u0435\u043C \u0437\u0430 \u0430\u043F\u0442\u0435\u0447\u043A\u043E\u0439 \u043D\u0430 "+e)):!u.dungObj.rooms[a].passed||u.ss[a].flboss=="boss"&&u.dungObj.objects[a]&&u.dungObj.objects[a].length!=0?(u.ss[a].flboss=="boss"&&u.dungObj.objects[a]&&u.dungObj.objects[a].length!=0&&(u.obj[o]=!0),e=u.ss[o].goboss,console.log("\u0438\u0434\u0435\u043C \u0432 \u043D\u0430\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0438 \u0431\u043E\u0441\u0441\u0430 \u043D\u0430 "+e)):(u.nextzone=r+u.appzone,u.nextzone>5&&(u.appzone=-1,u.nextzone=r+u.appzone),u.nextzone<1&&(u.appzone=1,u.nextzone=r+u.appzone),e=u.ss[o].goper[u.appzone+1],console.log("\u0438\u0434\u0435\u043C \u043A \u043F\u0435\u0440\u0435\u0445\u043E\u0434\u0443 \u0432 \u0437\u043E\u043D\u0443 "+u.nextzone+" \u043D\u0430 "+e)),$.post("/dungeon/gotoroom/",{referrer:"/dungeon/inside/",action:"gotoroom",room:e},function(c){AngryAjax.reload(),u.xod()},"json")},"json")};function sn(){u.xod()}var yt=sn;async function Fe(){await F(),AngryAjax.goToUrl("/alley/"),$(document).one("ajaxStop",async()=>{function e(){let n=$('.alley-sovet h3:contains("\u041F\u0440\u043E\u0442\u0438\u0432\u043E\u0441\u0442\u043E\u044F\u043D\u0438\u0435")').parent().find("span.f").attr("onclick");if(!n)return null;let o=n.match(/'([^']+)'(?:\s*\))/);return o?o[1]:null}let t=e();await fetch(new URL(window.location.href).origin+"/sovet/join_metro_fight/",{headers:{accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},body:`action=join_metro_fight&metro=2&type=metro&joinkey=${t}&__referrer=%2Falley%2F&return_url=%2Falley%2F`,method:"POST",mode:"cors"}),AngryAjax.goToUrl("/sovet/map/"),Groups.showCreateGroup("sovet")})}async function Re(){await fetch(new URL(window.location.href).origin+"/clan/profile/banzai/",{headers:{accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/clan/profile/banzai/",referrerPolicy:"strict-origin-when-cross-origin",body:`player=${player.id}&boost%5Bratingaccur%5D=10000&boost%5Bratingdamage%5D=10000&boost%5Bratingcrit%5D=10000&boost%5Bratingdodge%5D=10000&boost%5Bratingresist%5D=10000&boost%5Bratinganticrit%5D=10000&hours=8&__ajax=1&return_url=%2Fclan%2Fprofile%2Fbanzai%2F`,method:"POST",mode:"cors",credentials:"include"}),AngryAjax.goToUrl("/clan/profile/banzai/")}async function cn(){showAlert("\u{1F454} \u0420\u0435\u0436\u0438\u043C \u043F\u0440\u043E\u0442\u0438\u0432\u043E\u0441\u0442\u043E\u044F\u043D\u0438\u044F \u0432\u043A\u043B\u044E\u0447\u0435\u043D!","\u0417\u0430\u043F\u0438\u0441\u044B\u0432\u0430\u044E\u0441\u044C \u0432 \u043F\u0440\u043E\u0442 \u043A\u0430\u0436\u0434\u044B\u0435 30 \u043C\u0438\u043D\u0443\u0442, 5 \u043C\u0438\u043D\u0443\u0442 \u0434\u043E \u0431\u043E\u044F.")}async function ln(e){await fetch(new URL(window.location.href).origin+"/fight/",{headers:{accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-ch-ua":'"Chromium";v="131", "Not_A Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:`${new URL(window.location.href).origin}/fight/${e}/`,referrerPolicy:"strict-origin-when-cross-origin",body:`action=attack&json=1&__referrer=%2Ffight%2F${e}%2F&return_url=%2Ffight%2F${e}%2F`,method:"POST",mode:"cors",credentials:"include"})}function bt({title:e,children:t=[]}){let n=$(`<div class="block-bordered">
    <ins class="t l"><ins></ins></ins><ins class="t r"><ins></ins></ins>
    <div class="center clear">
      <h3>${e}</h3>
      <div class="petarena-training-description"></div>
    </div>
    <ins class="b l"><ins></ins></ins><ins class="b r"><ins></ins></ins>
  </div>`),o=n.find(".petarena-training-description");return t.forEach(r=>o.append(r)),n}async function pn(e){let t=await w(".petarena-training",`/petarena/train/${e}/`);if(!t)return;let n;return n=$(t).find(".abilities.hint-msg"),n.length||(n=$(t).find(".pet-info").next()),n=n.find(".object-thumb").filter((o,r)=>{let a=$(r),s=a.find(".action").length,c=a.find(".timer"),l=c.length,d=a.find("img");return c.css({borderCollapse:"collapse",emptyCells:"show",lineHeight:"1.3",listStyleType:"none",display:"block",background:"#ab6a33",border:"1px solid #804600",color:"white",fontSize:"12px",fontWeight:"bold",textAlign:"center",position:"absolute",left:"2px",top:"26px",padding:"0px 3px",borderRadius:"5px",cursor:"default"}),simple_tooltip(d),countdown(c),s||l}),n}function dn(){return $(".object-thumb").map((e,t)=>{let n=$(t);n.css({height:"auto"});let r=n.find(".action span:contains('\u043E\u0431\u0443\u0447\u0438\u0442\u044C')").parent().attr("onclick")?.match(/\/(\d+)\//)?.[1];if(r)return r}).get()}async function un(){if($("#pets-abilities").length>0)return;let e=$('<div id="pets-abilities"></div>').css({display:"flex",flexWrap:"wrap",maxWidth:"330px",gap:"4px",overflow:"auto",justifyContent:"center",alignItems:"center"}),t=_({text:"\u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u0430\u0431\u0438\u043B\u043A\u0438 \u043F\u0438\u0442\u043E\u043C\u0446\u0435\u0432",onClick:async()=>{let o=dn();for(let r of o){let a=await pn(r);e.append(a)}},className:"show-abilities",disableAfterClick:!0}),n=bt({title:"\u0410\u0431\u0438\u043B\u043A\u0438 \u043F\u0438\u0442\u043E\u043C\u0446\u0435\u0432",children:[e,t]});$(".inventary .equipment-cell").last().prepend(n)}async function xt(){if($("#pets-table").length)return;fn();let[e,t]=$(".block-bordered .center.clear").filter(function(){let r=$(this).find("h3").text().trim();return r==="\u0411\u043E\u0435\u0432\u0430\u044F \u041F\u0435\u0440\u0435\u043D\u043E\u0441\u043A\u0430 \u043F\u0438\u0442\u043E\u043C\u0446\u0435\u0432"||r==="\u0422\u0430 \u0441\u0430\u043C\u0430\u044F \u0440\u0435\u043B\u0438\u043A\u0432\u0430"}).get(),n=await w("table","/petarena/cage-relic/");n&&($(n).find("#equipment-accordion, dd, .object-thumbs").css({width:"auto",scrollbarWidth:"none",overflowY:"scroll"}).attr("id","pets-table"),$(t).append(n));let o=await w("table","/petarena/cage/");o&&($(o).find("#equipment-accordion, dd, .object-thumbs").css({width:"auto",height:"auto",scrollbarWidth:"none",overflowY:"scroll"}),$(e).append(o)),await un()}function fn(){let e=$(".inventary");e.find("tr").each(function(){let t=$(this).find("td"),n=t.eq(0).children().first(),o=t.eq(1).children().first();n.length&&e.find("tr:first td:first").append(n),o.length&&e.find("tr:first td:last").append(o),t.eq(0).is(":empty")&&t.eq(1).is(":empty")&&$(this).remove()}),$(".dopings-cell").first().find(".block-bordered").slice(0,2).remove(),$("#equipment-accordion .object-thumbs").first().children(".object-thumb").each((t,n)=>{let o=$(n);o.css({height:"auto"});let r=o.find(".action span:contains('\u043E\u0431\u0443\u0447\u0438\u0442\u044C')").parent(),a=r.attr("onclick")?.match(/\/(\d+)\//)?.[1];if(!a)return;$("<div>",{class:"take-pet action",html:"<span>\u0432 \u0431\u043E\u0439</span>",click:function(){petarenaSetActive(a,"battle")}}).insertAfter(r)})}function gn(e){let t=e.split("/"),n=t.at(-2),o=t.at(-1).split(".")[0];return[n,o]}function mn(){try{return $(".object-thumbs .object-thumb").has(".action.disabled").find("img").attr("src")}catch(e){console.log(`Could not find active tattoo.
`,e)}}async function oe(e=10){let t=mn();for(let n=0;n<e;n++)t&&await hn(t);$(document).one("ajaxStop",()=>yn()),AngryAjax.goToUrl(AngryAjax.getCurrentUrl())}async function hn(e){let[t,n]=gn(e);await fetch(new URL(window.location.href).origin+"/tattoo/",{headers:{accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/tattoo/",referrerPolicy:"strict-origin-when-cross-origin",body:`action=tattoo_mf&honey=0&style=${t}&id=${n}&ajax=1&__referrer=%2Ftattoo%2F&return_url=%2Ftattoo%2F`,method:"POST",mode:"cors",credentials:"include"})}var wn=_({text:"\u262F\uFE0F x10",onClick:async()=>{await oe(10),wn.classList.remove("disabled")},title:"10 \u043C\u043E\u0434\u0438\u0444\u0438\u043A\u0430\u0446\u0438\u0439 \u0432\u044B\u0431\u0440\u0430\u043D\u043D\u044B\u0445 \u0442\u0430\u0442\u0443\u0438\u0440\u043E\u043A"});function yn(){let e=$("#tattoo-alerts");e.length||(e=Y("tattoo-alerts")),$(".alert").each((t,n)=>{e.has(n).length||($(n).css("position","static").css("display","inline-block"),$(n).find("#alert-text").text().includes("\u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0443\u043B\u0443\u0447\u0448\u0438\u043B\u0438")&&($(n).find("#alert-title").css("background","green"),$(n).find(".close-cross").remove(),e.append(n)))})}var bn=[{text:"\u0432\u043D\u0435\u0437\u0430\u043F\u043D\u043E \u043E\u0436\u0438\u0432\u0430\u0435\u0442 \u043F\u0440\u0438 \u043F\u043E\u043C\u043E\u0449\u0438 \u0442\u0430\u0438\u043D\u0441\u0442\u0432\u0435\u043D\u043D\u043E\u0439 \u0447\u0451\u0440\u043D\u043E\u0439 \u043A\u043E\u0448\u043A\u0438, \u0432\u043E\u0437\u043D\u0438\u043A\u0448\u0435\u0439 \u0438\u0437 \u041C\u0430\u0442\u0440\u0438\u0446\u044B",img:"/@/images/obj/beast_ability/ability40.png"},{text:"\u0441 \u043F\u043E\u043C\u043E\u0449\u044C\u044E \u0440\u0435\u0430\u043D\u0435\u043C\u043E\u0431\u0438\u043B\u044F \u0432\u043E\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442\u0441\u044F \u0432 \u0431\u043E\u0439",img:"/@/images/obj/cars/162-big.png"},{text:"\u0433\u0440\u043E\u043C\u043A\u043E \u0447\u0438\u0442\u0430\u0435\u0442 QR-\u043A\u043E\u0434",img:"/@/images/ico/ability/bigbro_3.png"},{text:"\u043D\u0430\u0434\u0435\u0432\u0430\u0435\u0442 \u0442\u044E\u0440\u0431\u0430\u043D",img:"/@/images/ico/ability/bentley_abil.png"},{text:"\u0418\u0433\u0440\u0430 \u0432 \u041A\u0430\u043B\u044C\u043C\u0430\u0440\u0430 \u0416\u0435\u0441\u0442\u043E\u043A\u0430",img:"/@/images/loc/squid2025/abils/1.png"},{text:"\u043D\u0435\u0433\u0430\u0442\u0438\u0432\u043D\u044B\u0435 \u044D\u0444\u0444\u0435\u043A\u0442\u044B",img:"/@/images/ico/ability/abil_dyson.png"},{text:"\u043E\u0431\u043B\u0435\u0442\u0435\u0432 \u0432\u043E\u043A\u0440\u0443\u0433 \u0417\u0435\u043C\u043B\u0438",img:"/@/images/ico/ability/abil_kosmo2.png"},{text:"\u0432\u0438\u0434\u0438\u0442 \u043A\u0440\u0430\u0441\u043D\u044B\u0439 \u0441\u0432\u0435\u0442 \u0438 \u0437\u0430\u0441\u0442\u044B\u0432\u0430\u0435\u0442",img:"/@/images/loc/squid2025/abils/6.png"},{text:"\u0432 \u043A\u0443\u043A\u043B\u0443 \u0438 \u0442\u043E\u0442 \u043D\u0430\u0447\u0438\u043D\u0430\u0435\u0442 \u0437\u0430\u0441\u0442\u044B\u0432\u0430\u0442\u044C \u043A\u0430\u0436\u0434\u044B\u0435 2 \u0445\u043E\u0434\u0430",img:"/@/images/loc/squid2025/abils/6.png"},{text:"\u043D\u043E\u0441\u0442\u0430\u043B\u044C\u0433\u0438\u0440\u0443\u0435\u0442 \u0438 \u0432\u043E\u0441\u0441\u0442\u0430\u043D\u0430\u0432\u043B\u0438\u0432\u0430\u0435\u0442",img:"https://www.moswar.ru/@/images/ico/ability/car220.png"}],xn=[{text:"\u043F\u0443\u0441\u043A\u0430\u0435\u0442 \u043D\u0430 \u043A\u043E\u0442\u043E\u0448\u0430\u0432\u0435\u0440\u043C\u0443 \u0441\u0435\u0440\u0434\u0438\u0442\u043E\u0433\u043E \u043A\u043E\u0442\u0438\u043A\u0430",img:"/@/images/obj/../ico/ability/burrito_abil.png"},{text:"\u0442\u0430\u043A \u043F\u043E\u0442\u044F\u043D\u0443\u043B \u043A\u0430\u043D\u0430\u0442",img:"/@/images/obj/../ico/ability/squid_4.png"},{text:"\u043F\u0440\u0438\u0432\u0435\u0437 \u043D\u0430 \u0431\u0440\u043E\u043D\u0435\u043F\u043E\u0435\u0437\u0434\u0435 \u043C\u043E\u0433\u0443\u0447\u0435\u0433\u043E \u0441\u043E\u044E\u0437\u043D\u0438\u043A\u0430",img:"/@/images/ico/ability/kim_sum2.png"},{text:"\u0427\u0435\u0440\u043D\u0430\u044F \u0434\u044B\u0440\u0430 \u043F\u0440\u0438\u0445\u043E\u0434\u0438\u0442 \u043D\u0430 \u043F\u043E\u043C\u043E\u0449\u044C",img:"/@/images/ico/ability/black_hole.png"},{text:"\u0412\u043E\u0440\u043E\u043D\u043A\u0430 \u043F\u0440\u0438\u0445\u043E\u0434\u0438\u0442 \u043D\u0430 \u043F\u043E\u043C\u043E\u0449\u044C",img:"/@/images/ico/ability/tugboat.png"}];function vn(e){e||(e=$(".list-users--left"));let t=e.find("li.me");t.length&&t.prependTo(e);let n=y=>{let j=$(y).find('.player-rage .bar[tooltip="1"] .percent').attr("style")?.match(/width:(\d+(\.\d+)?)%/);return j?parseFloat(j[1]):0},o=y=>$(y).find('.user a[href^="/player/"]').text().trim(),r=y=>{let j=$(y).find(".fighter_hp").text().split("/")[1]?.trim();if(!j)return 0;let g=j.match(/([\d.,]+)([BkM]?)/);if(!g)return 0;let b=parseFloat(g[1].replace(",","."));switch(g[2]){case"B":return b*1e9;case"M":return b*1e6;case"k":return b*1e3;default:return b}},a=[],s=[],c=[],l=[],d=[];e.find("li").not(".me").each(function(){let y=this;if($(y).find('.player-rage .bar[tooltip="1"] .percent').length){let g=o(y);/^Клон «/.test(g)?c.push(y):g==="\u0411\u0440\u0430\u0442 \u041C\u0438\u0445\u0430\u043B\u044B\u0447\u0430"?l.push(y):$(y).hasClass("dead")?s.push(y):a.push(y)}else d.push(y)});let p=y=>y.sort((j,g)=>n(g)-n(j)),h=y=>y.sort((j,g)=>r(g)-r(j));function f(y){y.sort((j,g)=>{let b=$(j).hasClass("alive")?0:1,T=$(g).hasClass("alive")?0:1;return b-T})}f(p(a)),f(p(s)),f(p(c)),f(p(l)),f(h(d));let x=$('<div class="sorted-players-container">'),k=$('<div class="sorted-clones-container">'),L=$('<div class="sorted-special-npcs-container">'),R=$('<div class="sorted-secondary-npcs-container">');a.forEach(y=>x.append(y)),s.forEach(y=>x.append(y)),c.forEach(y=>k.append(y)),l.forEach(y=>L.append(y)),d.forEach(y=>R.append(y)),t.length?(R.insertAfter(t),L.insertAfter(t),k.insertAfter(t),x.insertAfter(t)):(e.prepend(R),e.prepend(L),e.prepend(k),e.prepend(x))}function vt(){if($("#enhanced-logs").length)return;let e=$log.find("div.text"),t=$("<div id='enhanced-logs'>").css({display:"flex",flexDirection:"column",gap:"4px",marginBottom:"8px"}),n=[...xn.map(a=>({...a,priority:0})),...bn.map(a=>({...a,priority:1}))],o=$log.find("div.text p").filter((a,s)=>{let c=$(s);return c.hasClass("rupor")&&c.text().includes("\u0411\u0440\u0430\u0442 \u041C\u0438\u0445\u0430\u043B\u044B\u0447\u0430")?(c.remove(),!1):n.some(({text:l})=>c.text().includes(l))}),r=[];o.each((a,s)=>{let c=$(s),l=n.find(({text:h})=>c.text().includes(h));if(!l)return;let d=$("<div>").css({display:"flex",alignItems:"center",gap:"4px",border:"1px solid rgb(103, 63, 0)",borderRadius:"4px",padding:"4px"}),p=$("<img>").attr("src",l.img).css({width:"32px",height:"32px"});d.append(p,c.clone()),r.push({priority:l.priority,$wrapper:d}),c.remove()}),r.sort((a,s)=>s.priority-a.priority).forEach(({$wrapper:a})=>t.append(a)),e.prepend(t),$(".forcejoin").each((a,s)=>{$(s).prependTo(e)})}function $t(){$(".list-users--left, .list-users--right").each(function(){vn($(this))})}function kt(){if(!$(".pagination").length){var e=$("#fightGroupForm"),t=e.find(".pagescroll").clone().addClass("pagination");if(!$(".block-rounded .cleanup-logs-btn").length){var n=_({text:"\u23E9",onClick:async()=>await P(),title:"\u041F\u0440\u043E\u043F\u0443\u0441\u0442\u0438\u0442\u044C \u041D\u041F\u0421 \u0431\u043E\u0439"});$(n).addClass("skip-npc-fight-btn").css({margin:"2px 6px"}),t.children().first().append(n)}e.prepend(t),$(".log-panel").prepend($(".fight-slots-actions"));var o=$("#fightAction");o.append('<i id="fight-action-reload" class="icon reload-icon" title="\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u0445\u043E\u0434"></i>'),$("#fight-action-reload").on("click",function(){o.show().find("button").show().removeClass("disabled").prop("disabled",!1),o.find(".waiting").hide()})}}var Z={Madness:{turns:"2",cnt:"",pn:"l",fstr:'p:contains("\u0431\u0435\u0448\u0435\u043D\u0441\u0442\u0432\u043E \u043D\u0430 2 \u0445\u043E\u0434\u0430")',image:'<i class="icon-madness deaf" style="margin:1px; filter:contrast(2.0);"></i>'},MadTrump:{turns:"1",cnt:"",pn:"l",fstr:'p:contains("\u043E\u0442\u043F\u0440\u0430\u0432\u043B\u044F\u0435\u0442 \u0432 \u0431\u0435\u0437\u0443\u043C\u0438\u0435")',image:'<i class="icon-madness deaf" style="margin:1px; filter:contrast(2.0);"></i>'},superhit6:{turns:"1",cnt:"",pn:"mf",fstr:'p:contains("\u0432\u043F\u0430\u0434\u0430\u0435\u0442 \u0432 \u0431\u0435\u0437\u0443\u043C\u0438\u0435 \u043D\u0430 1 \u0445\u043E\u0434!"):not(:contains("\u0437\u043C\u0435\u044F"))',image:'<i class="icon-madness deaf"></i>'},Snake:{turns:"1",cnt:"",pn:"mf",fstr:'p:contains("\u0432\u043F\u0430\u0434\u0430\u0435\u0442 \u0432 \u0431\u0435\u0437\u0443\u043C\u0438\u0435 \u043D\u0430 1 \u0445\u043E\u0434!"):contains("\u0437\u043C\u0435\u044F")',image:'<img class="icon deaf" src="/@/images/obj/pets/28-8.png" style="margin:1px;">'},Stun:{turns:"1",cnt:"",pn:"l",fstr:'p:contains(" \u0443\u043C\u0438\u043B\u044C\u043D\u043E \u0441\u043C\u043E\u0442\u0440\u0438\u0442 \u043D\u0430")',image:'<span class="stun deaf"><i style="margin:1px;"></i></span>'},totem:{turns:"1",cnt:"",pn:"l",fstr:'p:contains("\u0442\u043E\u0442\u0435\u043C\u0430 \u043E\u0433\u043B\u0443\u0448\u0430\u0435\u0442")',image:'<span class="stun deaf"><i style="margin:1px;"></i></span>'},Bear:{turns:"1",cnt:"",pn:"l",fstr:'p:contains("\u0441\u043B\u0443\u0447\u0430\u0439\u043D\u043E \u043E\u0433\u043B\u0443\u0448\u0430\u0435\u0442"):not(:contains("\u041F\u0443\u0433\u0430\u043B\u043E"))',image:'<i class="icon icon-bear deaf" style="filter: contrast(10.0); margin:1px; zoom:0.8;"></i>'},Snowman:{turns:"1",cnt:"",pn:"l",fstr:'p:contains("\u0441\u043B\u0443\u0447\u0430\u0439\u043D\u043E \u043E\u0433\u043B\u0443\u0448\u0430\u0435\u0442"):contains("\u041F\u0443\u0433\u0430\u043B\u043E")',image:'<img  class="icon deaf" src="/@/images/obj/beast_ability/ability11.png" style="filter:contrast(2.0);">'},Knockout:{turns:"1",cnt:"",pn:"l",fstr:'p:contains("\u0432\u044B\u0437\u044B\u0432\u0430\u0435\u0442 \u043B\u0430\u0432\u0438\u043D\u0443")',image:'<i class="icon icon-set-perk-knockout deaf" style="margin:1px;"></i>'},Bike:{turns:"1",cnt:"",pn:"",fstr:"",image:'<i class="icon icon-bike deaf" style="margin:1px;"></i>'},Hamsters:{turns:"",cnt:"",pn:"h",fstr:'p:contains("\u0436\u0435\u0432\u0430\u0442\u044C \u043F\u0440\u043E\u0432\u043E\u0434\u0430")',image:'<img  class="icon" src="/@/images/obj/pets/25-1.png" style="margin:1px; filter:contrast(2.0);">'},Hamshams:{turns:"-1",cnt:"",pn:"hh",fstr:'p.hamster:contains("\u043F\u0440\u0438\u0446\u0435\u043B\u0438\u0432\u0430\u0435\u0442\u0441\u044F \u0438 \u043D\u0430\u043F\u0430\u0434\u0430\u0435\u0442")',image:""},Robots_b:{turns:"4",cnt:"",pn:"l",fstr:'p:contains("\u0441\u0438\u043B\u043E\u0432\u043E\u0439 \u0431\u0440\u043E\u043D\u0435\u0439")',image:'<img class="icon" src="/@/images/obj/pets/29-4.png" style="margin:1px; filter:contrast(10.0);">'},Robots_o:{turns:"4",cnt:"",pn:"l",fstr:'p:contains("\u0430\u043A\u0442\u0438\u0432\u0438\u0440\u0443\u0435\u0442 \u043E\u0442\u0440\u0430\u0436\u0435\u043D\u0438\u0435")',image:'<img class="icon" src="/@/images/obj/pets/29-4.png" style="margin:1px; position:inherit; filter:hue-rotate(-90deg) opacity(60%);">'},Zimtime:{turns:"",cnt:"",pn:"f",fstr:'p:contains("\u0437\u0438\u043C\u043D\u0435\u0435 \u0432\u0440\u0435\u043C\u044F")',image:'<span class="sovetabil3"><i class="icon" style="margin:1px;"></i></span>'},Tornados:{turns:"4",cnt:"",pn:"f",fstr:'p:contains("\u0437\u0430\u0449\u0438\u0442\u0443 \u043E\u0442 \u0443\u0440\u043E\u043D\u0430 \u0438 \u0433\u0440\u0430\u043D\u0430\u0442 \u043D\u0430 70%")',image:'<img class="icon" src="/@/images/obj/superhits/superhit-10-3.png" style="margin:1px;">'},antigrnt:{turns:"4",cnt:"1",pn:"f",fstr:'p:contains("\u0429\u0438\u0442"):not(:contains("\u0421\u0442\u0430\u043B\u044C\u043D\u043E\u0439"))',image:'<span class="icon icon-antigranata" style="margin:1px; zoom:0.9;"></span>'},antigrnt2:{turns:"2",cnt:"1",pn:"f",fstr:'p:contains("\u0421\u0442\u0430\u043B\u044C\u043D\u043E\u0439 \u0449\u0438\u0442")',image:'<span class="icon icon-antigranata2" style="margin: 1px; zoom:0.9;"></span>'},helmet:{turns:"2",cnt:"1",pn:"f",fstr:'p:contains("\u041F\u0440\u043E\u0431\u043A\u043E\u0432\u0430\u044F \u043A\u0430\u0441\u043A\u0430")',image:'<span class="icon icon-helmet" style="margin: 1px;"></span>'},helmet3:{turns:"3",cnt:"1",pn:"f",fstr:'p:contains("\u041D\u043E\u0432\u043E\u0433\u043E\u0434\u043D\u0438\u0439 \u043D\u0430\u043F\u0438\u0442\u043E\u043A")',image:'<img class="icon" src="/@/images/obj/fight_item/weapon73.png" style="margin:1px;">'},reflect:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u041A\u043E\u0432\u0430\u0440\u043D\u0430\u044F \u043F\u0440\u0443\u0436\u0438\u043D\u0430")',image:'<span class="icon icon-reflect" style="margin: 1px;"></span>'},durian:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u0414\u0443\u0440\u0438\u0430\u043D \xAB\u0417\u0430\u043C\u043E\u0440\u0441\u043A\u0438\u0439\xBB"):not(:contains("\u043A\u0443\u0448\u0430\u0435\u0442"))',image:'<img class="icon" src="/@/images/obj/fight_item/weapon76.png" style="margin:1px;">'},kokos:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u041E\u0440\u0435\u0445 \xAB\u041A\u043E\u043A\u043E\u0441\u043E\u0432\u044B\u0439\xBB"):not(:contains("\u043A\u0443\u0448\u0430\u0435\u0442"))',image:'<img class="icon" src="/@/images/obj/fight_item/weapon74.png" style="margin:1px;">'},tikva:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u0422\u044B\u043A\u0432\u0430 \xAB\u041A\u043E\u043B\u0445\u043E\u0437\u043D\u0430\u044F\xBB"):not(:contains("\u043A\u0443\u0448\u0430\u0435\u0442"))',image:'<img class="icon" src="/@/images/obj/fight_item/weapon75.png" style="margin:1px;">'},granat:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u0413\u0440\u0430\u043D\u0430\u0442 \xAB\u041E\u0441\u043A\u043E\u043B\u043E\u0447\u043D\u044B\u0439\xBB"):not(:contains("\u043A\u0443\u0448\u0430\u0435\u0442"))',image:'<img class="icon" src="/@/images/obj/fight_item/weapon77.png" style="margin:1px;">'},rolls:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u0420\u043E\u043B\u043B\u044B")',image:'<img class="icon" src="/@/images/obj/drugs148.png" style="margin:1px;">'},vokker:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u0412\u043A\u0443\u0441\u043D\u044B\u0439 \u0432\u043E\u043A\u043A\u0435\u0440")',image:'<img class="icon" src="/@/images/obj/drugs179.png" style="margin:1px;">'},food87:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u0410\u043F\u0442\u0435\u0447\u043D\u044B\u0439 \u043D\u0430\u0431\u043E\u0440 \xAB\u041A\u0440\u0430\u0441\u043D\u044B\u0439\xBB")',image:'<img class="icon" src="/@/images/obj/fight_item/weapon87.png" style="margin:1px;">'},food86:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u0410\u043F\u0442\u0435\u0447\u043D\u044B\u0439 \u043D\u0430\u0431\u043E\u0440 \xAB\u041E\u0440\u0430\u043D\u0436\u0435\u0432\u044B\u0439\xBB")',image:'<img class="icon" src="/@/images/obj/fight_item/weapon86.png" style="margin:1px;">'},food79:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u041B\u0435\u0434\u0435\u043D\u0446\u044B \u0441 \u0438\u0433\u043E\u043B\u043A\u0430\u043C\u0438")',image:'<img class="icon" src="/@/images/obj/fight_item/weapon79.png" style="margin:1px;">'},food80:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u041D\u043E\u0432\u043E\u0433\u043E\u0434\u043D\u044F\u044F \u043A\u0430\u0440\u0430\u043C\u0435\u043B\u044C")',image:'<img class="icon" src="/@/images/obj/fight_item/weapon80.png" style="margin:1px;">'},cheese:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u0410\u0440\u043E\u043C\u0430\u0442\u043D\u044B\u043C \u0441\u044B\u0440\u043E\u043C")',image:'<span class="icon icon-cheese" style="margin: 1px; zoom:0.9;"></span>'},migrant:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u0422\u0440\u0443\u0434\u043E\u0432\u043E\u0439 \u043A\u043D\u0438\u0436\u043A\u043E\u0439")',image:'<img class="icon" src="/@/images/obj/fight_item/migrant.png" style="margin:1px;">'},lenin:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u043F\u0440\u0438\u0437\u044B\u0432\u0430\u0435\u0442 \u0412\u043E\u0436\u0434\u044F")',image:'<img class="icon" src="/@/images/obj/neftlenin_head.png" style="margin:1px;">'},grena82:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u0413\u0440\u0430\u043D\u0430\u0442\u0430 \xAB\u041F\u043E\u0440\u0430\u0437\u0438\u0442\u0435\u043B\u044C\u043D\u0430\u044F\xBB")',image:'<img class="icon" src="/@/images/obj/fight_item/weapon82.png" style="margin:1px;">'},grena83:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u0413\u0440\u0430\u043D\u0430\u0442\u0430 \xAB\u0414\u0443\u0445\xBB")',image:'<img class="icon" src="/@/images/obj/fight_item/weapon83.png" style="margin:1px;">'},grena84:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u0413\u0440\u0430\u043D\u0430\u0442\u0430 \xAB\u041A\u0438\u0441\u043B\u043E\u0442\u043D\u0430\u044F\xBB")',image:'<img class="icon" src="/@/images/obj/fight_item/weapon84.png" style="margin:1px;">'},grena85:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u0413\u0440\u0430\u043D\u0430\u0442\u0430 \xAB\u0421\u0432\u0435\u0442\u043B\u044F\u0447\u043E\u043A\xBB")',image:'<img class="icon" src="/@/images/obj/fight_item/weapon85.png" style="margin:1px;">'},grena66m1:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u041A\u043E\u043A\u0442\u0435\u0439\u043B\u044C \u041C\u043E\u043B\u043E\u0442\u043E\u0432\u0430 [\u0423\u043B\u044C\u0442\u0440\u0430]")',image:'<img class="icon" src="/@/images/obj/weapon66_mf1.png" style="margin:1px;">'},grena66:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u041A\u043E\u043A\u0442\u0435\u0439\u043B\u044C \u041C\u043E\u043B\u043E\u0442\u043E\u0432\u0430"):not(:contains("[\u0423\u043B\u044C\u0442\u0440\u0430]"))',image:'<img class="icon" src="/@/images/obj/weapon66.png" style="margin:1px;">'},grena63m2:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u041A\u043B\u0430\u0441\u0442\u0435\u0440\u043D\u0430\u044F \u0433\u0440\u0430\u043D\u0430\u0442\u0430 [\u041C\u0435\u0433\u0430]")',image:'<img class="icon" src="/@/images/obj/weapon63_mf2.png" style="margin:1px;">'},grena63m1:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u041A\u043B\u0430\u0441\u0442\u0435\u0440\u043D\u0430\u044F \u0433\u0440\u0430\u043D\u0430\u0442\u0430 [\u0423\u043B\u044C\u0442\u0440\u0430]")',image:'<img class="icon" src="/@/images/obj/weapon63_mf1.png" style="margin:1px;">'},grena63:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u041A\u043B\u0430\u0441\u0442\u0435\u0440\u043D\u0430\u044F \u0433\u0440\u0430\u043D\u0430\u0442\u0430"):not(:contains("[\u0423\u043B\u044C\u0442\u0440\u0430]")):not(:contains("[\u041C\u0435\u0433\u0430]"))',image:'<img class="icon" src="/@/images/obj/weapon63.png" style="margin:1px;">'},c4:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u0412\u0437\u0440\u044B\u0432\u0447\u0430\u0442\u043A\u0430 \u04214")',image:'<img class="icon" src="/@/images/obj/fight_item/weapon88.png" style="margin:1px;">'},grena37:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u0431\u043E\u043C\u0431\u0430-\u0432\u043E\u043D\u044E\u0447\u043A\u0430")',image:'<img class="icon" src="/@/images/obj/weapon37.png" style="margin:1px;">'},grena38:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u0425\u043B\u043E\u043F\u0443\u0448\u043A\u0430\u2014\u0440\u0430\u0437\u043B\u0443\u0447\u043D\u0438\u0446\u0430")',image:'<img class="icon" src="/@/images/obj/weapon38.png" style="margin:1px;">'},grena46:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u041C\u043E\u0449\u043D\u044B\u0439 \u0441\u043D\u0435\u0436\u043E\u043A")',image:'<img class="icon" src="/@/images/obj/weapon46.png" style="margin:1px;">'},grena79:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u0412\u0437\u0440\u044B\u0432\u043D\u043E\u0439 \u043C\u0430\u043D\u0434\u0430\u0440\u0438\u043D")',image:'<img class="icon" src="/@/images/obj/fight_item/weapon79.png" style="margin:1px;">'},grduck:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u0413\u0440\u0430\u043D\u0430\u0442\u0430 \xAB\u0423\u0442\u043E\u0447\u043A\u0430\xBB")',image:'<img class="icon" src="/@/images/obj/dung_prize/duck.png" style="margin:1px;">'},easydo:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u0421\u0432\u0435\u0442\u043E\u0448\u0443\u043C\u043E\u0432\u0430\u044F \u0433\u0440\u0430\u043D\u0430\u0442\u0430")',image:'<img class="icon" src="/@/images/obj/weapon62.png" style="margin:1px;">'},svistok:{turns:"1",cnt:"1",pn:"f",fstr:'p:contains("\u0432 \u0431\u043E\u0439 \u043E\u0442\u0440\u044F\u0434 \u041E\u041C\u041E\u041D\u0430")',image:'<img class="icon" src="/@/images/obj/item28.png" style="margin:1px;">'},easytarg:{turns:"5",cnt:"",pn:"et",fstr:'p:contains("\u0421\u0432\u0435\u0442\u043E\u0448\u0443\u043C\u043E\u0432\u0430\u044F \u0433\u0440\u0430\u043D\u0430\u0442\u0430")',image:'<i class="icon icon-easytarget" style="margin:1px;"></i>'},dim:{turns:"2",cnt:"1",pn:"f",fstr:'p:contains("\u0414\u044B\u043C\u043E\u0432\u0430\u044F \u0448\u0430\u0448\u043A\u0430")',image:'<i class="icon icon-foggranade" style="margin:1px;"></i>'},sovetabil7:{turns:"1",cnt:"5",pn:"f",fstr:'p:contains("\u043A\u043E\u043C\u0430\u043D\u0434\u0443\u0435\u0442 \u041E\u041C\u041E\u041D\u0443")',image:'<span class="sovetabil7"><i class="icon" style="margin:1px;"></i></span>'},sovetabil1:{turns:"1",cnt:"",pn:"f",fstr:'p:contains("\u0432\u043E\u043E\u0434\u0443\u0448\u0435\u0432\u043B\u044F\u0435\u0442 \u0438\u0437\u0431\u0438\u0440\u0430\u0442\u0435\u043B\u0435\u0439")',image:'<span class="sovetabil1"><i class="icon" style="margin:1px;"></i></span>'},periscope:{turns:"1",cnt:"",pn:"f",fstr:'p:contains("\u0432\u044B\u0437\u044B\u0432\u0430\u0435\u0442 \u043F\u043E\u0434\u043B\u043E\u0434\u043A\u0443")',image:'<span class="sub-periscope"><i></i></span>'},"rage-1":{turns:"",cnt:"",pn:"f",fstr:'p:contains("\u0432\u0441\u043F\u043B\u044B\u0432\u0430\u0435\u0442 \u0441\u043E \u0434\u043D\u0430")',image:'<span class="rage-1"><i style="zoom:0.9; margin:1px;"></i></span>'},car_sw2:{turns:"3",cnt:"5",pn:"f",fstr:'p:contains("\u0410\u0431\u0441\u043E\u043B\u044E\u0442\u043D\u0443\u044E \u0437\u0430\u0449\u0438\u0442\u0443")',image:'<img class="icon" src="/css/images/obj/beast_ability/ability_sw_hide.png" style="margin:1px;">'},ruslan:{turns:"1",cnt:"9",pn:"f",fstr:'p:contains("\u043F\u043E\u043F\u043E\u043B\u043D\u044F\u0435\u0442 \u0437\u0430\u043F\u0430\u0441\u044B \u0431\u043E\u0435\u043F\u0440\u0438\u043F\u0430\u0441\u043E\u0432")',image:'<img class="icon" src="/@/images/obj/cars/70.png" style="margin:1px; filter: contrast(2.0);">'},tramp:{turns:"1",cnt:"5",pn:"f",fstr:'p:contains("\u0432\u0435\u043B\u0438\u043A\u0438\u043C, \u043A\u0430\u043A")',image:'<img class="icon" src="/@/images/loc/trump/talant_3.png" style="margin:1px; filter: contrast(2.0);">'},mgs:{turns:"1",cnt:"5",pn:"l",fstr:'p:contains("\u041C\u043E\u0441\u0413\u043E\u0441\u0421\u0442\u0440\u0430\u0445")',image:'<img class="icon" src="/@/images/obj/8march2/items/128/6.png" style="margin:1px; filter: contrast(2.0);">'},rabbit:{turns:"1",cnt:"5",pn:"l",fstr:'p:contains("\u041F\u0430\u0441\u0445\u0430\u043B\u044C\u043D\u044B\u0439 \u043A\u0440\u043E\u043B\u0438\u043A")',image:'<img class="icon" src="/@/images/obj/rabbit.png" style="margin:1px;">'},rocketab1:{turns:"1",cnt:"",pn:"f",fstr:'p:contains("\u0420\u0430\u043A\u0435\u0442\u0430 \u0438\u0433\u0440\u043E\u043A\u0430")',image:'<i class="icon icon-rocket-1" style="margin:1px;"></i>'},sany:{turns:"1",cnt:"2",pn:"f",fstr:'p:contains("\u043A\u0430\u0442\u0430\u0435\u0442\u0441\u044F \u043D\u0430 \u0441\u0430\u043D\u044F\u0445")',image:'<img class="icon" src="/@/images/obj/cars/56.png" style="margin:1px;">'},roketxsany:{turns:"1",cnt:"",pn:"l",fstr:'p:contains("\u0441\u043F\u043E\u0441\u043E\u0431\u043D\u043E\u0441\u0442\u044C \u041D\u043E\u0432\u043E\u0433\u043E\u0434\u043D\u0435\u0435 \u0432\u044B\u0437\u0434\u043E\u0440\u043E\u0432\u043B\u0435\u043D\u0438\u0435")',image:'<img class="icon" src="/@/images/obj/cars/56.png" style="margin:1px;"><span style="color:#001dff; margin-left:-10px; font-size:14px;">&otimes;</span>'},gazi:{turns:"1",cnt:"2",pn:"f",fstr:'p:contains("\u0416\u0435\u0440\u0442\u0432\u0430 \u043E\u0442\u0440\u0430\u0432\u043B\u044F\u0435\u0442\u0441\u044F")',image:'<img class="icon" src="/@/images/obj/cars/51.png" style="margin:1px;">'},roketxgazi:{turns:"1",cnt:"",pn:"l",fstr:'p:contains("\u0441\u043F\u043E\u0441\u043E\u0431\u043D\u043E\u0441\u0442\u044C \u0412\u044B\u0445\u043B\u043E\u043F\u043D\u044B\u0435 \u0433\u0430\u0437\u044B")',image:'<img class="icon" src="/@/images/obj/cars/51.png" style="margin:1px;"><span style="color:#ff0000; margin-left:-10px; font-size:14px;">&otimes;</span>'},rocketab2:{turns:"1",cnt:"9",pn:"f",fstr:'p:contains("\u043E\u0431\u043B\u0435\u0442\u0435\u0432 \u0432\u043E\u043A\u0440\u0443\u0433 \u0417\u0435\u043C\u043B\u0438")',image:'<i class="icon icon-rocket-2" style="margin:1px;"></i>'},noheal:{turns:"",cnt:"",pn:"l",fstr:'p:contains("\u043D\u0435 \u043C\u043E\u0436\u0435\u0442 \u0432\u043E\u0441\u0441\u0442\u0430\u043D\u043E\u0432\u0438\u0442\u044C \u0437\u0434\u043E\u0440\u043E\u0432\u044C\u0435 \u043D\u0438\u0447\u0435\u043C")',image:'<span class="icon icon-heal" style="margin:1px;position:relative;"><span style="color:#ff0000; position:absolute; font-size:14px; left:4px; top:-4px;">&otimes; </span></span>'},car_sw:{turns:"1",cnt:"5",pn:"f",fstr:'p:contains("\u0417\u0432\u0435\u0437\u0434\u0430 \u0441\u043C\u0435\u0440\u0442\u0438")',image:'<img class="icon" src="/css/images/obj/beast_ability/ability_sw_deathray_2.png" style="margin:1px;">'},forcejoin:{turns:"1",cnt:"",pn:"f",fstr:'p:contains("\u0432\u043C\u0435\u0448\u0438\u0432\u0430\u0435\u0442\u0441\u044F \u0432 \u0431\u043E\u0439")',image:'<span class="icon icon-forcejoin" style="margin:1px;"></span>'},kgranat:{turns:"4",cnt:"",pn:"f",fstr:'p:contains("\u041A\u0430\u043B\u044C\u044F\u043D \xAB\u0413\u0440\u0430\u043D\u0430\u0442\u043E\u0432\u044B\u0439\xBB")',image:'<img class="icon" src="/@/images/obj/shisha/red1.png" style="margin:1px;">'},kled:{turns:"6",cnt:"",pn:"f",fstr:'p:contains("\u041A\u0430\u043B\u044C\u044F\u043D \xAB\u041B\u0435\u0434\u044F\u043D\u043E\u0439\xBB")',image:'<img class="icon" src="/@/images/obj/shisha/frost1.png" style="margin:1px;">'},nokick:{turns:"2",cnt:"",pn:"f",fstr:'p:contains("\u041D\u0435 \u0431\u0435\u0439\u0442\u0435 \u0435\u0433\u043E!")',image:'<span class="red">\u041D\u0435 \u0431\u0438\u0442\u044C! </span>'},malina:{turns:"1",cnt:"",pn:"f",fstr:'p:contains("\u0440\u0430\u0437\u0433\u0430\u0434\u044B\u0432\u0430\u0435\u0442 \u041A\u043E\u043C\u0431\u0438\u043D\u0430\u0446\u0438\u044E \u041F\u0430\u0445\u0430\u043D\u0430")',image:'<img class="icon" src="/@/images/obj/vovan_note.png" style="margin:1px;">'}};function Ho(){(typeof window.localStorage.OptionsVar>"u"||window.localStorage.OptionsVar==null)&&(window.localStorage.OptionsVar=JSON.stringify({f_pickabil:"u"}));var e=JSON.parse(window.localStorage.OptionsVar);if(location.pathname.search(/^\/fight/)!==-1){let o=function(){let c=JSON.parse(window.sessionStorage.fightLog),l=parseInt($(".block-rounded").find(".current").text(),10);e.f_hidedead&&$(".list-users").find(".dead").remove();for(let d in c){if(d==="\u0418\u0437\u0431\u0440\u0430\u043D\u043D\u044B\u0439[??]"){$(".log").find(".log-panel").append(`<div class="fight-log">${c[d].Turns}</div>`);continue}let p="",h="";for(let f in Z)if(f in c[d]){let x=c[d][f],k=0;f==="Hamsters"?k=x.Turns:(k=x.Turns-(l-x.Step),k=k>0&&k<=x.Turns?k:0),k>0&&(p+=Z[f].image,k>1&&(p+=`<small>${k}</small>`)),"cnt"in x&&(h+=`
                <div style="display: inline-block; margin: 6px 0;">
                  ${Z[f].image}
                  <small style="margin-top: -3px; display: block; position: absolute;">
                    #${x.cnt}
                  </small>
                </div>`)}if(p||h){let f=$("#fightGroupForm").find(`.user:contains("${d}")`).first();p&&f.addClass("fight-log").prepend(`${p}<br>`),h&&f.parent().append(`
                <br>
                <div class="fight-log cnt" style="position: absolute; margin-top: -10px;">
                  ${h}
                </div>
                <div style="height: 20px;"></div>
              `)}}},r=function(){let c=location.href.split("/")[2],l=parseInt($(".block-rounded").find(".current").text(),10),d=window.sessionStorage;(c!==d.FightId||!d.fightLog||d.fightLog==="undefined")&&(d.FightId=c,d.fightLog=JSON.stringify({}));var p=JSON.parse(window.sessionStorage.fightLog),h=$(".block-rounded").find(".current").text(),f="",x="";if($(".group").text().search(/Избранный/)!==-1){var k="\u0418\u0437\u0431\u0440\u0430\u043D\u043D\u044B\u0439\xA0[??]";p["\u0418\u0437\u0431\u0440\u0430\u043D\u043D\u044B\u0439[??]"]={Turns:"",Step:h}}if($(".group").text().includes("\u0418\u0437\u0431\u0440\u0430\u043D\u043D\u044B\u0439")){let g="\u0418\u0437\u0431\u0440\u0430\u043D\u043D\u044B\u0439\xA0[??]";p[g]={Turns:"",Step:l}}function L(g,b,T,U,C){g=g.match(/(.{1,20})\s(\[.+?\])/);let v=g?`${g[1]}${g[2]}`:null;if(!v)return;if(v==="\u0418\u0437\u0431\u0440\u0430\u043D\u043D\u044B\u0439[??]"&&U!=="-1"){p[v].Turns+=C==="#"?C:`<br>${C}`;return}p[v]=p[v]||{},p[v][b]=p[v][b]||{};let M=p[v][b];if(C==="#"){M.cnt="#";return}if(b==="Hamshams"){p[v].Hamsters=p[v].Hamsters||{Turns:"0"},p[v].Hamsters.Turns=parseInt(p[v].Hamsters.Turns,10)+parseInt(U,10);return}M.Step=T,M.Turns=U,Z[b].cnt&&(M.cnt=M.cnt?M.cnt+1:1,M.Steps=M.Steps||[],M.Steps.includes(T)||M.Steps.push(T))}function R(g,b,T){let U=["Hamsters","Snake","superhit6","MadTrump","totem","Knockout"],C,v=null;switch(b){case"f":C=$(g).find('[class^="name-"]').first().text().match(/(.+?\[.+?\])/);break;case"l":C=$(g).find('[class^="name-"]').last().text().match(/(.+?\[.+?\])/);break;case"et":for(v=$(g).next();!v.is(".easytarget");)v=v.next();C=R(v,"f",T);break;case"h":case"hh":v=y(g),v.text().includes("\u043E\u0442\u043F\u0440\u0443\u0436\u0438\u043D\u0438\u0432\u0430\u0435\u0442 \u0443\u0434\u0430\u0440")?C=R(v,b==="h"?"f":"l",T):C=R(v,b==="h"?"l":"f",T);break;default:break}return C&&C[1]===k&&U.includes(T)&&(x=`<small>${v.text().replace(/\s{2,}/g," ").match(/^\d?([\s\S]+?\][\s\S]+?\])/)[1]}</small>`),C}function y(g){let b=$(g).prev();for(;;){let T=b.text();if(T.match(/\[.+?\]/g)?.length>1&&!T.match(/змея|Тесла|дракон|Ночной страж/))break;b=b.prev()}return b}let j=$("#fightGroupForm").find(".fight-log");for(let g in Z){let{fstr:b,cnt:T,pn:U,turns:C}=Z[g];b&&j.find(b).each(function(){let v=R(this,U,g);v||(v=R(this,U==="l"?"f":"l",g)),v&&L(v[1],g,l,C||$(this).text().match(/\s(\d)\s/)[1],x||"")})}j.find('.text:contains("\u0411\u0430\u0439\u043A ")').each(function(){let g=$(this).text().match(/Байк\s.+?оглушает.+?\[.+?\]/g);g&&g.forEach(b=>{let T=b.match(/оглушает\s(.+?\[.+?\])/)[1],U=T===k?`<small>${b}</small>`:"";L(T,"Bike",l,"1",U)})}),d.fightLog=JSON.stringify(p)},a=function(c){document.getElementById("sign_kick")==null&&(document.getElementById("useabl-"+c).click(),e.f_autokick&&($("#fightAction").find("button").click(),$("#useabl-"+c).parents("label").find("img").attr("style","filter:contrast(2.0)"),$("#f_autokick").prop("checked",!1),e.f_autokick=0,window.localStorage.OptionsVar=JSON.stringify(e)),$(".log-panel").attr("id","sign_kick"))},s=function(){if($("#sign_ufl").length!=1){if(r(),o(),$(".fight-log").find('[class*="icon"]:not(.icon-bang-poison):not(.icon-antigranata2):not(.question-icon):not(.icon-rocket-1):not(.icon-rocket-2):not(.icon-cheese):not(.icon-helmet):not(.icon-bear):not(.icon-antigranata):not(.icon-forcejoin):not(.icon-heal):not(.antimrr):not(.serial):not(.icon-bang):not(.icon-superhit):not(.icon-reflect):not(.icon-chance):not(.icon-dodge):not(.icon-secondhit):not(.icon-thirdhit):not(.icon-katyusha):not(.icon-weakening-after-madness):not(.icon-foggranade)').each(function(){var k=$(this).next().text().match(/(.*).\[/);if(k!==null){var L=$(".group").find('li .user:contains("'+k[1]+'")').first();$(L).is(".fight-log")?$(L).children("br").first().before($(this).clone()):$(L).addClass("fight-log").prepend("<br>").prepend($(this).clone())}}),e.f_topmylog){var c=$("ul.fight-log").find(".text");$('<div style="border:blue 1px solid;"></div>').prepend(c.find("p.attack_i, p.attack_me").clone()).prependTo(c)}if(!$(".group2 i").is(".npc")){var l=$(".list-users--right"),d=l.find("li.alive");e.f_topmig&&l.prepend(d.filter(':contains("\u041C\u0438\u0433\u0440\u0430\u043D\u0442 ")')).prepend(d.filter(':contains("\u041C\u0435\u0441\u044C\u0435 ")')),e.f_topmadness&&l.prepend(d.has(".deaf")),e.f_bottomomon&&(l.find("li.dead").length==0?l.append(d.filter(':contains("\u041E\u043C\u043E\u043D\u043E\u0432\u0435\u0446 ")')):l.find("li.dead").first().before(d.filter(':contains("\u041E\u043C\u043E\u043D\u043E\u0432\u0435\u0446 ")')))}var p=$("#fightGroupForm"),h=p.find(".pagescroll").clone();if(!$(".block-rounded .cleanup-logs-btn").length){var f=_({text:"\u23E9",onClick:async()=>await P(),title:"\u041F\u0440\u043E\u043F\u0443\u0441\u0442\u0438\u0442\u044C \u041D\u041F\u0421 \u0431\u043E\u0439"});$(f).addClass("skip-npc-fight-btn").css({margin:"2px 6px"}),h.children().first().append(f)}p.prepend(h),$(".superhit-wrapper").length!==0&&$(".superhit-wrapper").css("zoom","0.8");var x=$("#fightAction");x.append('<i id="fight-action-reload" class="icon reload-icon" title="\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u0445\u043E\u0434"></i>'),$("#fight-action-reload").on("click",function(){x.show().find("button").show().removeClass("disabled").prop("disabled",!1),x.find(".waiting").hide()}),$("#main").find("span.boj").on("click",function(){AngryAjax.goToUrl(location.pathname.replace(/(\/fight\/\d+?\/)\d+?\//,"$1"))}),p.find("table").attr("id","sign_ufl")}};var t=["148","-1","-65","59","155","146"];if(!$(".group2 i").is(".npc")&&($(".group1 i").is(".arrived")||$(".group1 img").is('[class^="team-"]'))&&!$("h3").is(".welcome-groupfight-flag")&&$("#fightGroupForm").find("ul.fight-log > li > h4").text()=="\u041D\u0430\u0447\u0430\u043B\u043E"&&$("#fightAction").find("button").is(":visible")){switch(e.f_pickabil){case"u":document.getElementById("useabl--1")!==null&&a("-1"),document.getElementById("useabl--65")!==null&&a("-65"),document.getElementById("useabl-148")!==null&&a("148");break;case"o":document.getElementById("useabl-59")!==null&&a("59"),document.getElementById("useabl-146")!==null&&a("146");break;case"a":document.getElementById("useabl-155")!==null&&a("155");break}if(document.getElementById("sign_kick")==null){for(var n=0;n<t.length;n++)if(document.getElementById("useabl-"+t[n])!==null){a(t[n]);break}}}s(),$(".log-panel").prepend($(".fight-slots-actions"))}}var qe=function(){typeof localStorage.mw_alerts>"u"&&(localStorage.mw_alerts="[]");let alertsData=JSON.parse(localStorage.mw_alerts);if(alertsData.length>0){for(var i in alertsData)showAlert("\u041E\u043F\u043E\u0432\u0435\u0449\u0435\u043D\u0438\u0435",alertsData[i]);alertsData=[],localStorage.mw_alerts="[]"}window.parseData=function(e,t){var n=JSON.parse(e);console.log(n);var o=new Array;for(var r in n.alerts)o.push(n.alerts[r].text);for(var a in n.inventory)if("inventory-"+n.inventory[a].code+"-btn"==t){var s={id:n.inventory[a].id,alerts:o};return s}var s={alerts:o};return s},window.parseDataItem=function(e,t){var n=JSON.parse(e);console.log(n);var o=new Array;for(var r in n.alerts)o.push(n.alerts[r].text);for(var a in n.inventory)if("/@/images/obj/"+n.inventory[a].image==t){var s={id:n.inventory[a].id,alerts:o};return s}var s={alerts:o};return s},window.buyNextGift=function(e,t,n,o,r,a){typeof r>"u"&&(r="\u041F\u043E\u0434\u0430\u0440\u043E\u043A"),e>0?$.get("/player/json/"+o+"/"+t+"/",function(s){moswar.showPopup(r+" \u043E\u0442\u043A\u0440\u044B\u0442!","\u041E\u0441\u0442\u0430\u043B\u043E\u0441\u044C: "+(e-1),4e3);var c=parseData(s,n);if(typeof c.id<"u"){var l=JSON.parse(localStorage.mw_alerts);for(var d in c.alerts)l.push(c.alerts[d]);localStorage.mw_alerts=JSON.stringify(l),buyNextGift(e-1,c.id,n,o,r,a)}else{var l=JSON.parse(localStorage.mw_alerts);for(var d in c.alerts)l.push(c.alerts[d]);localStorage.mw_alerts=JSON.stringify(l),a=="1"?(localStorage.listGiftsN=Number(localStorage.listGiftsN)-1,Number(localStorage.listGiftsN)<1&&setTimeout("AngryAjax.goToUrl('/player/');",1e3)):setTimeout("AngryAjax.goToUrl2('/player/');",2e3)}}):a=="1"?(localStorage.listGiftsN=Number(localStorage.listGiftsN)-1,Number(localStorage.listGiftsN)<1&&setTimeout("AngryAjax.goToUrl2('/player/');",1e3)):setTimeout("AngryAjax.goToUrl2('/player/');",2e3)};var buyNextItem=function(e,t,n,o,r,a){typeof r>"u"&&(r="\u041F\u0440\u0435\u0434\u043C\u0435\u0442"),e>0?$.get("/player/json/"+o+"/"+t+"/",function(s){moswar.showPopup(r+" \u043E\u0442\u043A\u0440\u044B\u0442!","\u041E\u0441\u0442\u0430\u043B\u043E\u0441\u044C: "+(e-1),4e3);var c=parseDataItem(s,n);if(typeof c.id<"u"){var l=JSON.parse(localStorage.mw_alerts);for(var d in c.alerts)l.push(c.alerts[d]);localStorage.mw_alerts=JSON.stringify(l),buyNextItem(e-1,c.id,n,o,r,a)}else{var l=JSON.parse(localStorage.mw_alerts);for(var d in c.alerts)l.push(c.alerts[d]);localStorage.mw_alerts=JSON.stringify(l),a=="1"?(localStorage.listGiftsN=Number(localStorage.listGiftsN)-1,Number(localStorage.listGiftsN)<1&&setTimeout("AngryAjax.goToUrl2('/player/');",1e3)):setTimeout("AngryAjax.goToUrl2('/player/');",2e3)}}):a=="1"?(localStorage.listGiftsN=Number(localStorage.listGiftsN)-1,Number(localStorage.listGiftsN)<1&&setTimeout("AngryAjax.goToUrl2('/player/');",1e3)):setTimeout("AngryAjax.goToUrl2('/player/');",2e3)};window.multOpenGift=function(e){var t=$(e).parent().parent().find("img").attr("data-id"),n=$(e).parent().parent().find(".action").attr("id"),o=$(e).parent().parent().find(".action").attr("data-action"),r=[];r.push({title:"\u041E\u0442\u043A\u0440\u044B\u0442\u044C",callback:function(a){alertsData=[],buyNextGift($("#multbuy").attr("value"),t,n,o,m.items[t].info.title,"0"),closeAlert(a)}}),r.push({title:"\u041E\u0442\u043C\u0435\u043D\u0430",callback:null}),showConfirm('<p align="center">\u041A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E: <input id="multbuy" value="'+$(e).parent().parent().find(".count").text().replace(/#/gi,"")+'"></p>',r,{__title:"\u041E\u0442\u043A\u0440\u044B\u0442\u044C \u043C\u043D\u043E\u0433\u043E :)"})},window.multOpenItem=function(e){var t=$(e).parent().parent().find("img").attr("data-id"),n=$(e).parent().parent().find("img").attr("src"),o=$(e).parent().parent().find(".action").attr("data-action"),r=[];r.push({title:"\u041E\u0442\u043A\u0440\u044B\u0442\u044C",callback:function(a){alertsData=[],buyNextItem($("#multbuy").attr("value"),t,n,o,m.items[t].info.title,"0"),closeAlert(a)}}),r.push({title:"\u041E\u0442\u043C\u0435\u043D\u0430",callback:null}),showConfirm('<p align="center">\u041A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E: <input id="multbuy" value="'+$(e).parent().parent().find(".count").text().replace(/#/gi,"")+'"></p>',r,{__title:"\u041E\u0442\u043A\u0440\u044B\u0442\u044C \u043C\u043D\u043E\u0433\u043E :)"})},window.initializePlayerPageEnhancements=function(){window.enhancePetItems(),window.enhanceEquipmentItems(),window.handleInventoryEnhancements()},window.enhancePetItems=function(){$('.object-thumb img[data-type="pet"]').each(function(){let e=$(this);if(e.parent().find(".action").attr("onclick").match(/train\/\d+\/'/)){let n=e.attr("data-id"),r=`\u0412\u0430\u0448 \u043F\u0438\u0442\u043E\u043C\u0435\u0446 ${m.items[n].info.title.replace(/"/g,"")} \u0441\u0434\u0435\u043B\u0430\u043D \u0430\u043A\u0442\u0438\u0432\u043D\u044B\u043C!`,s=`
          <div style="position: absolute">
            <span class="agree" onclick="${`petarenaSetActive(${n}, 'battle'); moswar.showPopup('\u041F\u0438\u0442\u043E\u043C\u0435\u0446', '${r}', 5000);`}" style="cursor: pointer">
              <i></i>
            </span>
          </div>`;e.parent().prepend(s)}})},window.enhanceEquipmentItems=function(){$('.equipment-cell .object-thumb .action[data-action="use"]').each(function(){let e=$(this);e.prev(".multi-open").length===0&&e.next(".multi-open").length===0&&e.parent().prepend(`
          <b class="multi-open" style="cursor: pointer; background-color: #fdf179; color: green; font-size: 11px; position: absolute; margin: 0 1px;" onclick="multOpenItem(this);">
            [#]
          </b>`)}),$('.equipment-cell .object-thumb img[data-type="gift"]').each(function(){let e=$(this);e.prev(".multi-open").length===0&&e.next(".count").length===1&&e.before(`
          <b class="multi-open" style="cursor: pointer; background-color: #fdf179; color: green; font-size: 11px; position: absolute; margin: 0 1px;" onclick="multOpenGift(this);">
            [#]
          </b>`)})},window.handleInventoryEnhancements=function(){setTimeout(()=>{moveInventoryItemsToCategories()},150)},window.moveInventoryItemsToCategories=function(){let e='.object-thumbs[htab="inventory"]',t='.object-thumbs[htab="clothes"]';$(`${e} img[src$="box_perfume.png"], 
       ${e} img[src$="gift-wolf.png"], 
       ${e} img[src$="gold_phone_cert.png"], 
       ${e} img[src$="eye_phone_cert.png"]`).parents(".object-thumb").appendTo(e),$(`${t} img[data-type="talisman"], 
       ${t} img[data-type="cologne"]`).parents(".object-thumb").prependTo(t),$(`${t} img[data-type="phone"]`).parents(".object-thumb").appendTo(t)},location.pathname.endsWith("/player/")&&(eval("AngryAjax.goToUrl2 = "+AngryAjax.goToUrl.toString().replace("url = url.replace('#', '');","")),initializePlayerPageEnhancements())},_t=function(){typeof window.GM_deleteValue>"u"&&(window.GM_addStyle=e=>{let t=document.createElement("style");t.textContent=e,document.head.appendChild(t)},window.GM_deleteValue=e=>{localStorage.removeItem(e)},window.GM_getValue=(e,t)=>{let n=localStorage.getItem(e);if(n===null)return t;let o=n.charAt(0),r=n.slice(1);switch(o){case"b":return r==="true";case"n":return Number(r);default:return r}},window.GM_log=e=>{console.log(e)},window.GM_openInTab=e=>{window.open(e,"_blank")},window.GM_registerMenuCommand=(e,t)=>{},window.GM_setValue=(e,t)=>{let n;if(typeof t=="boolean")n="b";else if(typeof t=="number")n="n";else if(typeof t=="string")n="s";else throw new Error("Unsupported value type");let o=`${n}${t}`;localStorage.setItem(e,o)});function getCurrentLocation(){var e=$(".heading:first h2 span"),t=e.length>0?e[0].getAttribute("class"):$(".heading:first h2").html();return t}function getRealDoc(){var e=top.document.getElementById("game-frame");return e?e.contentWindow.document:top.document}function renderEatDopsButton(){let e=Adoc.getElementById("dopings-accordion");if(!Adoc.getElementById("eat-button")&&getCurrentLocation()==="pers"&&e){let t=document.createElement("div");t.className="button",t.id="eat-button",t.innerHTML=`
        <span class="f">
          <i class="rl"></i>
          <i class="bl"></i>
          <i class="brc"></i>
          <div id="aicheck" class="c">\u041E\u0431\u043E\u0436\u0440\u0430\u0442\u044C\u0441\u044F</div>
        </span>
      `,$('div[htab="dopings"]').before(t),t.addEventListener("click",selectDops,!1),setTimeout(()=>{eatDops()},1e3)}}function selectDops(){if(getCurrentLocation()=="pers"&&Adoc.getElementById("dopings-accordion")){var e=document.createElement("DIV");e.setAttribute("style","display: block; top: 300px; width: 468px;"),e.setAttribute("class","alert  alert1"),e.id="alert-main";var t=document.createElement("DIV");t.setAttribute("class","padding"),e.appendChild(t);var n=document.createElement("H2");n.innerHTML="\u0412\u044B\u0431\u0440\u0430\u0442\u044C \u0434\u043E\u043F\u044B",t.appendChild(n);var o=document.createElement("DIV");o.setAttribute("class","data");var r=document.createElement("DIV");o.appendChild(r),t.appendChild(o);for(var a=Adoc.getElementById("dopings-accordion").cloneNode(!0),s=a.getElementsByClassName("object-thumb");s.length>0;){var c=document.createElement("DIV");c.setAttribute("style","margin: 4px 1px 2px 2px;height: 72px; width: 72px;float:left;"),c.setAttribute("name","backGroundDiv");var p=s[0].getElementsByClassName("action")[0],l=s[0].getElementsByClassName("padding")[0].getElementsByTagName("img")[0];if(p){if(p.className=="action disabled")c.style.backgroundColor="red";else{var d="$.get('/player/json/"+p.getAttribute("data-action")+"/"+l.getAttribute("data-id")+"/', function(){moswar.showPopup('\u0413\u043E\u0442\u043E\u0432\u043E',m.items["+l.getAttribute("data-id")+"].info.title, 2000);GM_setValue('listDopsN', Number(GM_getValue('listDopsN', ''))-1);if(Number(GM_getValue('listDopsN', ''))<1) {AngryAjax.goToUrl('/player/');}})";c.setAttribute("rel",d),c.addEventListener("click",function(){onClickBackGroundDiv(this)},!1)}s[0].getElementsByClassName("padding")[0].removeChild(p)}s[0].setAttribute("style","margin: 2px 2px 2px 2px;height: 68px;"),c.appendChild(s[0]),r.appendChild(c)}var p=document.createElement("DIV");p.setAttribute("class","actions"),p.setAttribute("style","clear: both;");var h=document.createElement("DIV");h.setAttribute("class","button"),h.innerHTML='<span class="f"><i class="rl"></i><i class="bl"></i><i class="brc"></i><div class="c">\u041E\u041A</div></span>';var f=document.createElement("DIV");f.setAttribute("class","button"),f.innerHTML='<span class="f"><i class="rl"></i><i class="bl"></i><i class="brc"></i><div class="c">\u041E\u0442\u043C\u0435\u043D\u0430</div></span>',p.appendChild(h),p.appendChild(f),o.appendChild(p),Adoc.body.appendChild(e),f.addEventListener("click",function(){Adoc.body.removeChild(Adoc.getElementById("alert-main"))},!1),h.addEventListener("click",createListDops,!1)}}function createListDops(){for(var e=Adoc.getElementsByName("backGroundDiv"),t="",n=0;n<e.length;n++)e[n].style.backgroundColor=="green"&&(t+=e[n].getAttribute("rel")+"#|#");t=t.substring(0,t.length-3),GM_setValue("listDops",t),GM_setValue("listDopsN",t.split("#|#").length),Adoc.body.removeChild(Adoc.getElementById("alert-main")),eatDops()}function onClickBackGroundDiv(e){e.style.backgroundColor=e.style.backgroundColor=="green"?"transparent":"green"}function eatDops(){var listDops=GM_getValue("listDops","");if(listDops){var codeBlocks=listDops.split("#|#"),codeBlock=codeBlocks[0],cl=codeBlocks.length;eval(codeBlock),codeBlocks.shift(),codeBlocks[0]?(GM_setValue("listDops",codeBlocks.join("#|#")),setTimeout(function(){eatDops()},1e3)):GM_setValue("listDops","")}}var Adoc=getRealDoc();renderEatDopsButton()};function Tt(){myphone.appShowHide=function(e,t){if(t=="hide")e.attr("style","display: none");else if(t=="show"){var n=e.attr("id");e.css({opacity:0,display:"block"}).css("transform","scale(0.5)").animate({opacity:1},{duration:1,easing:"easeInOutQuint",step:function(o,r){e.css("-webkit-transform","scale("+o+")"),e.css("-moz-transform","scale("+o+")"),e.css("-ms-transform","scale("+o+")"),e.css("transform","scale("+o+")")},complete:function(){switch($("#amulet-reward_buffs").fadeOut("slow"),n){case"app-trade":myphone.getTradeContract();break;case"app-trade2":myphone.getTradeItem();break;case"app-messages":myphone.getFightList();break;case"app-mfphone":$("button",e).unbind("click").bind("click",function(){AngryAjax.goToUrl("/phone/call/mf-item/"+myphone.currentPhone+"/")});break}console.log("\u041A\u043E\u043B\u0431\u044D\u043A \u043F\u043E\u044F\u0432\u043B\u0435\u043D\u0438\u044F \u043E\u0431\u044A\u0435\u043A\u0442\u0430"),e.hasClass("scrollable")&&!e.hasClass("jspScrollable")&&(console.log("\u0418\u043D\u0438\u0446\u0438\u0430\u0446\u0438\u044F \u0441\u043A\u0440\u043E\u043B\u043B\u0431\u0430\u0440\u043E\u0432"),e.jScrollPane())}})}}}function Y(e,t=""){let n=$(`#${e}`);if(!n.length){n=$("<div>",{id:e}).css({position:"fixed",width:"50%",top:"30%",left:"50%",transform:"translateX(-50%)",minHeight:"35vh","overflow-y":"auto","overflow-x":"hidden",display:"flex","flex-wrap":"wrap","justify-content":"center","align-items":"center",gap:"10px",padding:"10px","border-radius":"8px",background:"rgba(0, 0, 0, 0.8)","box-shadow":"0px 4px 10px rgba(0, 0, 0, 0.3)","z-index":9999,"scrollbar-width":"thin","pointer-events":"auto",border:"none"}),t&&n.attr("style",`${n.attr("style")}; ${t}`);let o=_({text:"X",onClick:()=>{n.remove(),AngryAjax.reload()},title:"\u0417\u0430\u043A\u0440\u044B\u0442\u044C \u043E\u043A\u043D\u043E"}),r=$(o).css({position:"absolute",top:"2%",right:"2%","z-index":99999});n.append(r),$("body").prepend(n)}return n}function ue(){DungeonViewer.tryToGoToRoom=function(e){if($("#preview-map").hasClass("data-prevent-click")){$("#preview-map").removeClass("data-prevent-click");return}DungeonViewer.activePlayerMoving||Dungeon.isCanGoToRoom(e)&&Dungeon.goToRoom(e,function(t){DungeonViewer.movePlayerToRoom(0,e,t)})},Dungeon.goToRoom=function(e,t){Dungeon.activeRequest||(Dungeon.activeRequest=!0,typeof e!="number"&&(e=e.replace("room-","")),postUrl("/dungeon/gotoroom/",{action:"gotoroom",room:e},"post",function(n){Dungeon.activeRequest=!1,DungeonViewer.initCooldown(n.cooldown),(n.result||n.return_url)&&AngryAjax.goToUrl(AngryAjax.getCurrentUrl())}))}}function fe(){CasinoKubovich.rotate=function(){if(CasinoKubovich.rotateInterval=null,!CasinoKubovich.mayRotate)return!1;CasinoKubovich.mayRotate=!1;var e=parseInt($("#fishki-balance-num").html().replace(",","")),t=parseInt($("#push .fishki").text());if(!isNaN(t)&&t>e){CasinoKubovich.errorChip();return}CasinoKubovich.endPosition=null,CasinoKubovich.result=null;var n="";$("div.reel-yellow").length?n="yellow":n="black",$.post("/casino/kubovich/",{action:n},function(o){if(CasinoKubovich.result=o,CasinoKubovich.result)if(CasinoKubovich.result.success)CasinoKubovich.showMessage(CasinoKubovich.result.text);else if(!CasinoKubovich.result.ready)clearInterval(CasinoKubovich.rotateInterval),CasinoKubovich.rotateInterval=null,CasinoKubovich.mayRotate=!0,$("#prizes").empty(),$("#reel-turning").attr("class",""),$("#push .cost").html(" - \u0441\u043A\u043E\u0440\u043E"),$("#push").addClass("disabled"),$("#push-ellow").addClass("disabled"),$("#steps tr.my").removeClass("my"),$("#kubovich-smile").show(),CasinoKubovich.showError("\u041A \u0441\u043E\u0436\u0430\u043B\u0435\u043D\u0438\u044E \u0432 \u0434\u0430\u043D\u043D\u044B\u0439 \u043C\u043E\u043C\u0435\u043D\u0442 \u041A\u0443\u0431\u043E\u0432\u0438\u0447 \u043E\u0442\u0434\u044B\u0445\u0430\u0435\u0442, \u043F\u0440\u0438\u0445\u043E\u0434\u0438\u0442\u0435 \u043F\u043E\u0437\u0436\u0435.");else if(CasinoKubovich.result.reload){var r=!1;$("div.reel-yellow").length&&(r=!0),CasinoKubovich.loadData(r)}else CasinoKubovich.errorChip();if(CasinoKubovich.result.wallet){var a={};a.money=CasinoKubovich.result.wallet.money,a.ore=CasinoKubovich.result.wallet.ore,a.honey=CasinoKubovich.result.wallet.honey,updateWallet(a)}CasinoKubovich.rotateInterval=null,CasinoKubovich.mayRotate=!0;var s=0,c=0;$("#kubovich-message button").unbind("click"),$("#kubovich-message button").bind("click",function(){$("#kubovich-message").hide(),$("#kubovich-message .data .text").html("")}),CasinoKubovich.nextStep()},"json")}}function ge(){NeftLenin.attack=function(){$.post("/neftlenin/",{ajax:1,action:"startAction"},function(e){e.result?AngryAjax.reload():(e.return_url&&AngryAjax.goToUrl(e.return_url),e.error&&showAlert(m.lang.LANG_MAIN_105,e.error,!0,"",".welcome"))},"json")},NeftLenin.escape=function(){$.post("/neftlenin/",{ajax:1,action:"escape"},function(e){if(e.result){var t=NeftLenin.getAlertForStep();t.find(".progress-wrapper").css({opacity:1}).animate({opacity:0},{duration:1,complete:function(){t.find(".awards").html(e.data),$(this).animate({opacity:1},1)}}),NeftLenin.init(e),$(".enemy-place").hide()}else e.return_url&&AngryAjax.goToUrl(e.return_url),e.error&&showAlert(m.lang.LANG_MAIN_105,e.error,!0,"",".welcome")},"json")},NeftLenin.reset=function(e){$(".pipeline-actions .button").hasClass("disabled")||$.post("/neftlenin/",{ajax:1,action:"reset",type:e},function(t){if($(".pipeline-actions .button").removeClass("disabled"),t.result){NeftLenin.init(t);var n=NeftLenin.getAlertForStep();n.css("display")=="block"&&(n.find(".awards").html(t.data),n.fadeIn("slow")),t.honey&&($(".med-block span").text(intToKM(t.honey)),$(".med-block").attr("title","\u041C\u0435\u0434\u0430: "+t.honey))}else t.return_url&&AngryAjax.goToUrl(t.return_url),t.error&&showAlert(m.lang.LANG_MAIN_105,t.error,!0,"",".welcome");NeftLenin.fixAlertPosition(n)},"json")},NeftLenin.viewPreMission=NeftLenin.viewPreMission2}var $n=[{text:"\u{1F354}",title:"\u0420\u0430\u0431\u043E\u0442\u0430 \u0438 \u043F\u0430\u0442\u0440\u0443\u043B\u044C",onClick:async()=>{await X(1),await D(10)}},{text:"\u{1F400}",title:"\u041A\u0440\u044B\u0441\u044B \u0430\u0432\u0442\u043E\u043F\u0438\u043B\u043E\u0442",onClick:async()=>await N(5)},{text:"\u{1F4B5}",title:"\u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u0432\u0430\u043B\u044E\u0442\u0443",className:"show-currency",onClick:async e=>{let t=e.currentTarget,n=await _n();$("#currency-container").length?$("#currency-container").replaceWith(n):(n.hide(),$(t).parent().append(n),n.slideToggle())},disableAfterClick:!1},{text:"\u{1F52E}",title:"\u0421\u0438\u0440\u0438 \u043E\u0442\u043B\u043E\u0436\u043A\u0430 (\u0437\u0430 3 \u0441\u0435\u043A\u0443\u043D\u0434\u044B)",onClick:async()=>await xe()},{text:"\u{1F17F}\uFE0F",title:"\u0414\u044D\u043F\u0441 \u043E\u0442\u043B\u043E\u0436\u043A\u0430 (\u0437\u0430 10 \u043C\u0438\u043D\u0443\u0442)",onClick:async()=>await De()},{text:"\u{1F531}",title:"\u0411\u043E\u0439 \u0441 \u041F\u0430\u0445\u0430\u043D\u043E\u043C",onClick:async()=>{confirm("\u0417\u0430\u043F\u0438\u0441\u0430\u0442\u044C\u0441\u044F \u043D\u0430 \u043F\u0430\u0445\u0430\u043D\u0430?")&&He()},disableAfterClick:!1},{text:"\u{1F44A}",title:`50 \u0431\u043E\u0435\u0432 \u0432 \u0437\u0430\u043A\u043E\u0443\u043B\u043A\u0438 \u043E\u0431\u043E\u0440\u043E\u0442\u043D\u0435\u043C (\u0443\u0440\u043E\u0432\u0435\u043D\u044C \u043E\u0431\u043E\u0440\u043E\u0442\u043D\u044F - 1)
\u043D\u0443\u0436\u043D\u044B: \u043E\u0431\u043E\u0440\u043E\u0442\u0435\u043D\u044C + \u043C\u0430\u0436\u043E\u0440 + \u0441\u043D\u0438\u043A\u0435\u0440\u0441\u044B/\u0442\u043E\u043D\u0443\u0441)`,onClick:async()=>await Oe(50),disableAfterClick:!1},{text:'<img src="/@/images/obj/jobs/item6.png" style="width: 16px; height: 16px; transform: scale(1.5);">',onClick:be,title:"\u041A\u0443\u0448\u0430\u0442\u044C \u0441\u043D\u0438\u043A\u0435\u0440\u0441",disableAfterClick:!1},{text:"\u{1F5FC}",title:"\u0422\u0443\u0440\u0435\u043B\u044C + \u043C\u0435\u0442\u0430\u043B\u043B\u043E\u0434\u0435\u0442\u0435\u043A\u0442\u043E\u0440 (\u0435\u0441\u043B\u0438 \u0435\u0441\u0442\u044C)",onClick:async()=>{await fetch("/turret/23018/",{headers:{accept:"*/*","accept-language":"en-GB,en;q=0.9","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/turret/23018/",body:"action=search&__ajax=1&return_url=%2Fturret%2F23018%2F",method:"POST",mode:"cors"}),await fetch(new URL(window.location.href).origin+"/turret/23018/",{headers:{accept:"*/*","accept-language":"en-GB,en;q=0.9","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/turret/23018/",body:"action=metaldetector&__ajax=1&return_url=%2Fturret%2F23018%2F",method:"POST",mode:"cors"}),await fetch(new URL(window.location.href).origin+"/turret/23018/",{headers:{accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/turret/23018/",body:"action=install",method:"POST",mode:"cors",credentials:"include"}),AngryAjax.goToUrl(AngryAjax.getCurrentUrl())}},{text:"\u{1F93A}",title:"\u0417\u0430\u043F\u0438\u0441\u044C \u043D\u0430 \u0445\u0430\u043E\u0442 \u0437\u0430 30 \u0441\u0435\u043A\u0443\u043D\u0434 \u0434\u043E \u0431\u043E\u044F, \u043A\u0430\u0436\u0434\u044B\u0435 15 \u043C\u0438\u043D\u0443\u0442.",onClick:Ee},{text:"\u{1F454}",title:`\u0417\u0430\u043F\u0438\u0441\u044C \u043D\u0430 \u043F\u0440\u043E\u0442.
(\u0412\u043E\u043A\u0437\u0430\u043B\u044C\u043D\u044B\u0439)`,onClick:Fe,disableAfterClick:!1},{text:"\u26A1\uFE0F",title:"\u041F\u0440\u0438\u043B\u0438\u0432 \u0431\u043E\u0434\u0440\u043E\u0441\u0442\u0438 (\u0411\u0430\u043D\u0437\u0430\u0439!).",onClick:Re,disableAfterClick:!1},{text:"\u26CF\uFE0F",title:"\u0421\u043F\u0443\u0441\u043A \u0432 \u043C\u0435\u0442\u0440\u043E \u043A\u0430\u0436\u0434\u044B\u0435 10 \u043C\u0438\u043D\u0443\u0442. (\u041A\u043E\u043B\u043B\u0435\u043A\u0446\u0438\u044F \u0428\u0435\u043B\u043A\u0443\u043D\u0447\u0438\u043A)",onClick:async()=>await ie()},{text:"\u{1F6A9}",title:"\u0421\u043E\u0431\u0438\u0440\u0430\u0435\u043C \u0434\u0435\u0442\u0430\u043B\u0438 \u0411\u0440\u043E\u043D\u0435\u043F\u043E\u0435\u0437\u0434\u0430 \u0420\u0435\u0432\u043E\u043B\u044E\u0446\u0438\u0438",onClick:async()=>await V()},{text:"\u{1F573}\uFE0F",title:"\u041E\u0434\u0438\u043D\u043E\u0447\u043D\u0430\u044F \u043F\u043E\u0434\u0437\u0435\u043C\u043A\u0430, \u0430\u0432\u0442\u043E\u043F\u0440\u043E\u0445\u043E\u0436\u0434\u0435\u043D\u0438\u0435",onClick:yt}],kn=[{href:"/dungeon",text:"\u{1F573}\uFE0F \u041F\u043E\u0434\u0437\u0435\u043C\u043A\u0430"},{href:"/neftlenin/",text:"\u{1F6E2}\uFE0F \u041D\u0435\u0444\u0442\u044C"},{href:"/metro/",text:"\u{1F400} \u041A\u0440\u044B\u0441\u044B"},{href:"/bank/",text:"\u{1F3E6} \u0411\u0430\u043D\u043A"},{href:"/square/tvtower/",text:"\u{1F4FA} \u0422\u0412"},{href:"/nightclub/",text:"\u{1FAA9} \u041A\u043B\u0443\u0431"},{href:"/huntclub/wanted/",text:"\u{1F3AF} \u041E\u041A"},{href:"/home/relic/",text:"\u{1F9E9} \u0420\u0435\u043B\u0438\u043A\u0442\u044B"},{href:"/camp/gypsy/",text:"\u2728 \u0426\u044B\u0433\u0430\u043D\u043A\u0430"},{href:"/berezka/section/mixed/",text:"\u{1F6CD}\uFE0F \u0411\u0435\u0440\u0435\u0437\u043A\u0430"},{href:"/metrowar/clan/",text:"\u{1F687} \u041C\u0435\u0442\u0440\u043E\u0432\u0430\u0440"},{href:"/sovet/career/",text:"\u{1F454} \u0413\u043E\u0441\u041F\u0440\u043E\u043C"},{href:"/meetings/team/",text:"\u{1FAA7} \u041C\u0438\u0442\u044B"},{href:"/petarena/",text:"\u{1F9AE} \u041F\u0435\u0442\u044B"},{href:"/squid/",text:"\u{1F991} \u041A\u0430\u043B\u044C\u043C\u0430\u0440"},{href:"/travel2/",text:"\u{1F30D} \u0420\u0435\u0439\u0434\u044B"},{href:"/automobile/ride/",text:"\u{1F695} \u041F\u043E\u0435\u0437\u0434\u043A\u0430"}];function A({title:e,img:t,text:n}){let o=$("<div>").css({display:"flex",alignItems:"center",justifyContent:"flex-start",gap:"8px",borderRadius:"5px",overflow:"hidden"}),r=$("<span>").text(n),a=$("<img>").attr("src",t).css({width:"84px",height:"84px",objectFit:"cover",objectPosition:"right"});t&&o.append(a),o.append(r),showAlert(e,o.prop("outerHTML"))}async function Pe(){try{let e=$('<div id="assistant-container"></div>').css({position:"absolute",display:"flex",maxWidth:"120px",maxHeight:"600px",height:"auto",gap:"20px",flexDirection:"column",alignItems:"flex-end",backgroundColor:"rgb(255, 244, 225)",top:"258px",padding:"12px 10px",borderWidth:"2px",borderStyle:"solid",borderColor:"rgb(209, 148, 92)",borderRadius:"12px",zIndex:"999999"});$(".body-bg").append(e),e.hide(),$(document).on("click",()=>e.hide()),e.on("click",n=>n.stopPropagation()),$(document).on("contextmenu",n=>{n.preventDefault(),e.css({left:n.pageX,top:n.pageY}).slideToggle("fast")});let t=$('<div id="assistant-autopilot"></div>').css({display:"flex",gap:"8px",width:"100%",minWidth:"80px",flexWrap:"wrap",justifyContent:"space-around"});$n.forEach(({text:n,title:o,onClick:r,condition:a,disableAfterClick:s})=>{if(a===!1)return;let c=_({text:n,title:o,onClick:r,disableAfterClick:s});t.append(c)}),e.append(t)}catch(e){console.log(`\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u043D\u0430\u0440\u0438\u0441\u043E\u0432\u0430\u0442\u044C \u043F\u0430\u043D\u0435\u043B\u044C \u043D\u0430\u0432\u0438\u0433\u0430\u0446\u0438\u0438.
`,e)}}async function Ie(){if($("#navbar-links").length>0)return;let e=$('<div id="navbar-links" class="borderdata"></div>').css({display:"flex",position:"sticky",top:"8px",justifyContent:"center",flexWrap:"wrap",gap:"16px 32px",alignItems:"center",padding:"10px 12px",zIndex:"102",border:"2px solid #ffd591",background:"#f9f6ec",borderRadius:"8px",margin:"14px",boxShadow:"rgba(0, 0, 0, 0.25) 0px 0px 8px 4px"});kn.forEach(({href:n,text:o,onClick:r})=>{let a=$("<a></a>").text(o).css("text-decoration","none");r?a.attr("href","#").on("click",s=>{s.preventDefault(),r()}):a.attr({href:n,onclick:"return AngryAjax.goToUrl(this, event);"}),e.append(a)}),$("#main").children().eq(1).before(e)}async function _n(){let e=await w(".borderdata","/berezka/section/mixed/"),t=$('<div id="currency-container"></div>');t.css({width:"100%","min-width":"120px",display:"flex","flex-wrap":"wrap",gap:"12px 2px","justify-content":"space-between"});let n=[...Array.from(e.children)].map(o=>{let r=o.innerText,a=parseInt(r.replace(/[^0-9]/g,""),10);return isNaN(a)||(o.title=r,o.innerHTML=ee(a)+o.querySelector("i").outerHTML),$(o).css({display:"inline-flex",alignItems:"center"}),o});return t.empty().append(n),t}async function he(){if(AngryAjax.getCurrentUrl()!=="/player/")return;location.pathname.search(/\/player\/$/)!==-1&&qe();function e(){document.querySelector("#content > table.inventary > tbody > tr > td.equipment-cell > div").style.width="577px",document.querySelector("#content > table.inventary > tbody > tr > td.equipment-cell > div > dl").style.width="577px",document.querySelector("#content > table.inventary > tbody > tr > td.equipment-cell > div > dl > dd").style.width="577px"}function t(){if(document.querySelector("#dopings-accordion").style.width="80px",document.querySelector("#dopings-accordion > dd").style.width="80px",$("#dopings-accordion > dd > .object-thumbs").css({height:"955.5px"}),$(".action.use-all-siri").length)return;let s=$(`
      <div class="action use-all-siri"><span>\u043E\u0431\u043C\u0435\u043D \u0432\u0441\u0435</span></div>
    `);s.on("click",async()=>{s.hasClass("disabled")||(s.addClass("disabled"),await Ge(),s.removeClass("disabled"))}),$('.object-thumbs[htab="inventory"] img[src="/@/images/obj/phones/siri_64.png"]').parent().append(s)}function n(){document.querySelector("#pet-accordion").style.width="220px",document.querySelector("#pet-accordion > dd > div.object-thumbs").style.width="220px"}function o(){let s=$("img[data-st='10483']").closest(".padding"),c=parseInt(s.find(".count").text().replace("#",""),10);s.find(".action span").text("\u0432\u043D\u0435\u0441\u0442\u0438").parent().removeAttr("onclick").on("click",async()=>{await ft(c),AngryAjax.reload(),A({title:"\u0412\u0441\u0435 \u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u043E \u0441\u0434\u0435\u043B\u0430\u043B!",text:`\u0412\u044B \u0432\u043D\u0435\u0441\u043B\u0438 ${c} \u0438\u0437\u0443\u043C\u0440\u0443\u0434\u043E\u0432.`,img:"/@/images/obj/clan/emerald.png"})})}function r(){let s=[14820,10292,8799,813,10097,14730,3347,4020],c=$('.htabs-submenu[rel="inventory"]').first(),l=$();s.forEach(d=>{let p=$(`.object-thumb:has(img[data-st='${d}'])`);p.length&&l.push(p[0])}),c.after(l)}let a=document.querySelector("#content > table.inventary > tbody > tr > td.equipment-cell > div > dl > dd > div:nth-child(1)");t(),e(),n(),qe(),_t(),o(),setTimeout(r,500),a&&a.offsetHeight<300&&(console.log("[i] toggle inventory expand"),inventaryExpand.toggle())}function we(){function e(n){let r=/^(\d\d).(\d\d).(\d{4}) (\d\d):(\d\d)$/.exec(n);if(r){let[a,s,c,l,d,p]=r;return new Date(Date.UTC(l,c-1,s,d-3,p,59))}return null}function t(){let n=0,o=0,r=async a=>{let s=$(".help").find(`.brown:contains("${a}")`);if(s.length>0){let c=s.html().split("\u0434\u043E ")[1];c&&(localStorage.candyExpiration=c.split(" \u2014")[0])}};if(r("\u041A\u043E\u043D\u0444\u0435\u0442\u0430 \xAB\u0423\u043C\u043D\u0430\u044F\xBB"),r("\u041A\u043E\u043D\u0444\u0435\u0442\u0430 \xAB\u0413\u043B\u0443\u043F\u0430\u044F\xBB"),localStorage.candyExpiration){let a=Number($("#servertime").attr("rel")),s=e(localStorage.candyExpiration);s&&(o=Math.round(s.getTime()/1e3),n=o-a)}n<0&&(n=0),!$("#candyTimer")[0]&&n>0&&($("#personal").prepend(`<span id="candyTimer" style="position:absolute;top: -11px;left: 46px;padding: 2px;background-color:rgb(255, 227, 179);border-radius: 8px;border-bottom-right-radius: 0px;border-bottom-left-radius: 0px;border: 2px solid rgb(240 114 53);">
          <span style="display: flex; gap: 2px;" class="expa"><i></i><b id="countdownTimer" timer="10" endtime="${o}"></b></span>
        </span>`),countdown("#countdownTimer",0,!1,async function(){await Be()}),countdown("#countdownTimer",0))}t()}async function Me(){return new Promise(e=>{AngryAjax.goToUrl("/alley/"),$(document).one("ajaxStop",()=>{let t=location.pathname;e(/\/fight\/(?!.*\/alley\/)/.test(t))})})}function Tn(){if(!$("#modify-many-container").length)try{$(".tattoo").css("height","1000px"),$(".tattoo-slider").css("height","700px"),$(".tattoo-slider-slides").css("height","100%"),$(".tattoo-slider-slide__container").css("height","100%");let e=q('<div id="modify-many-container" style="display: flex; gap: 10px;"></div>');[4,8,12].forEach(t=>{let n=_({text:`\u262F\uFE0F x${t}`,onClick:async()=>await oe(t),title:`\u041F\u043E\u043F\u0440\u043E\u0431\u043E\u0432\u0430\u0442\u044C \u0441\u0430\u043C\u043E\u043C\u0443 \u0445${t} \u0440\u0430\u0437`});e.appendChild(n)}),E({action:async()=>await oe(1),min:1,max:100}),$(".tattoo-draft-color-actions").append(e),$(".tattoo-draft-color-actions").append(E({action:async()=>await oe(1),label:"\u041F\u043E\u043F\u0440\u043E\u0431\u043E\u0432\u0430\u0442\u044C \u0441\u0430\u043C\u043E\u043C\u0443",min:1,max:100}))}catch{console.log("could not redraw tattoo")}}function Sn(){let e=["\u043F\u0435\u043B\u044C\u043C\u0435\u043D\u044C","\u041A\u0443\u0431\u0438\u043A\u0438 \u041C\u043E\u0441\u043A\u043E\u0432\u043E\u043F\u043E\u043B\u0438\u0438","\u042D\u043B\u0435\u043C\u0435\u043D\u0442 \u0441\u043B\u0443\u0447\u0430\u0439\u043D\u043E\u0439 \u043A\u043E\u043B\u043B\u0435\u043A\u0446\u0438\u0438","\u0425\u0440\u0443\u0441\u0442\u044F\u0449\u0438\u0435 \u0432\u0430\u0444\u043B\u0438","\u043F\u043E\u0434\u0437\u0435\u043C\u043A\u0443","\u041D\u0430\u0431\u043E\u0440 \u043A\u043B\u044E\u0447\u0435\u0439","\u0420\u0430\u0441\u043F\u044B\u043B\u0438\u0442\u0435\u043B\u044C \u0434\u043B\u044F \u0434\u0443\u0445\u043E\u0432","\u041E\u0433\u043D\u0435\u043D\u043D\u044B\u0435 \u041A\u043E\u043A\u0442\u0435\u0439\u043B\u0438"];$(".tv-tower-news-tab-content").each(function(){let t=$(this),n=t.find(".tv-tower-news-article").toArray();n.sort((o,r)=>{let a=$(o).find(".tv-tower-award").text().trim(),s=$(r).find(".tv-tower-award").text().trim(),c=e.some(d=>a.includes(d));return e.some(d=>s.includes(d))-c}),t.append(n)})}function St(){function e(){$("#welcome-rat button:nth-child(3)").replaceWith($("#search_other_rat > div > div > div:nth-child(4)").clone().on("click",function(){$(document).one("ajaxStop",function(){e(),t()})}))}function t(){async function n(){await fetch(new URL(window.location.href).origin+"/metro/fight-rat/",{headers:{accept:"*/*","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/metro/",referrerPolicy:"strict-origin-when-cross-origin",body:"__referrer=%2Fmetro%2F&return_url=%2Fmetro%2F",method:"POST",mode:"cors"})}$('button[onclick="metroFightRat();"]').removeAttr("onclick").off("click").on("click",async function(){await n(),$(document).one("ajaxStop",async function(){Cn()&&await P()}),AngryAjax.goToUrl("/metro/")})}e(),t()}function An(){let e=["/metro/","/travel2/","/neftlenin/from_battle","/dungeon/inside/"],t=$(".result a.f").attr("href");t&&e.includes(t)&&(console.log("redirecting to",t),F(),AngryAjax.goToUrl(t))}function jn(){let e=$("#miniChat");if(e.length>0){e.css({left:"3px",top:"570px",width:"200px",height:"470px",position:"absolute"});let t=e.find(".content");t&&t.scrollTop(t[0]?.scrollHeight)}vt(),$t(),kt()}function Cn(){return!!location.pathname.match(/^(?!.*\/alley\/).*\/fight\//)}function Ln(){$(".object-thumbs").css({height:"auto",maxHeight:"850px",overflowY:"scroll",scrollbarWidth:"none"})}function Un(){$(".home-collections-redrawn").length>0||($("#home-collections").css({display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr"}).attr("class","home-collections-redrawn"),$(".object-thumb").each(function(){$(this).css({height:"auto"});let e=$(this).find("img").attr("title");/коллекция/i.test(e)&&(e=e.replace(/коллекция/i,""));let t=$("<span>").text(e).css({"word-break":"break-all","font-size":"smaller"});$(this).find("a").append(t)}))}function Fn(){if($(".bringup-mode-btn").length)return;$(".progress .num").html(function(n,o){return o.replace(/Баллов набрано:\s*/,"")});let e=_({text:"\u{1F695}",title:"\u0411\u043E\u043C\u0431\u0438\u0442\u044C \u0431\u0435\u0441\u043F\u043B\u0430\u0442\u043D\u043E (\u043F\u043E\u043A\u0430 \u0432\u043A\u043B\u0430\u0434\u043A\u0430 \u043E\u0442\u043A\u0440\u044B\u0442\u0430)",className:"bringup-mode",onClick:async()=>{if(window.BRINGUP_MODE){showAlert("\u0411\u043E\u043C\u0431\u0438\u043B\u0430 \u{1F695}","\u0420\u0435\u0436\u0438\u043C \u0443\u0436\u0435 \u0430\u043A\u0442\u0438\u0432\u0435\u043D.");return}let n=$('form[action="/automobile/bringup/"] input[name="car"]').val();if(!n){A({title:"\u0411\u043E\u043C\u0431\u0438\u043B\u0430 \u{1F695}",img:"/@/images/link/taxi.jpg",text:`
          \u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u043D\u0430\u0439\u0442\u0438 ID \u0430\u0432\u0442\u043E\u043C\u043E\u0431\u0438\u043B\u044F.
          `});return}await H(n),window.BRINGUP_MODE=!0,AngryAjax.reload(),A({title:"\u0411\u043E\u043C\u0431\u0438\u043B\u0430 \u{1F695}",img:"/@/images/link/taxi.jpg",text:`
        \u0420\u0435\u0436\u0438\u043C \u0431\u043E\u043C\u0431\u0438\u0442\u044C \u0431\u0435\u0441\u043F\u043B\u0430\u0442\u043D\u043E.
        <br>\u0427\u0442\u043E\u0431\u044B \u043E\u0442\u043A\u043B\u044E\u0447\u0438\u0442\u044C, \u043E\u0431\u043D\u043E\u0432\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0443.<br>
        <i>(id \u0442\u0430\u0447\u043A\u0438: ${n})</i>.
        `})}}),t=$(".auto-bombila .actions");t.find("form").css({display:"inline-block"}),t.append(e)}function Rn(){if($("#neftlenin-switch").length)return;let e=$('<div id="neftlenin-switch"></div>').css({position:"absolute",top:"20px",right:"5px",display:"flex",gap:"2px",alignItems:"center",justifyContent:"center",boxShadow:"rgba(0, 0, 0, 0.25) 0px 0px 8px 4px"}),t=_({text:"\u26AA\uFE0F",title:"\u041E\u0431\u044B\u0447\u043D\u044B\u0439 \u043D\u0435\u0444\u0442\u0435\u043F\u0440\u043E\u0432\u043E\u0434",onClick:()=>$.post("/neftlenin/",{action:"selectType",type:"usual"},function(){AngryAjax.reload()})}),n=_({text:"\u26AB\uFE0F",title:`\u0422\u0435\u043C\u043D\u044B\u0439 \u043D\u0435\u0444\u0442\u0435\u043F\u0440\u043E\u0432\u043E\u0434
(\u2757\uFE0F\u0432\u043D\u0435 \u0430\u043A\u0446\u0438\u0438 \u0432\u0432\u043E\u0434\u0438\u0442 \u043F\u0435\u0440\u0441\u043E\u043D\u0430\u0436\u0430 \u0432 \u0442\u044E\u0440\u044C\u043C\u0443 \u043D\u0430 20 \u043C\u0438\u043D\u0443\u0442\u2757\uFE0F)`,onClick:()=>$.post("/neftlenin/",{action:"selectType",type:"hard"},function(){AngryAjax.reload()})});e.append(t,n),$(".welcome").append(e)}function qn(){window.jobShowTonusAlert=function(){$.get("/job/tonus-buy-alert/",function(e){e.error?showAlert(moswar.lang.LANG_MAIN_105,e.error,!0):$.get("/player/json/use/"+e.restore_tonus+"/",function(t){console.log(t.restore_tonus),t.fullenergyin&&(player.fullenergyin=0,$("div.tonus-overtip-increase").html(),$(".plus-icon").eq(1).css("display","")),t.stats.energy&&(setEnergy(t.stats.energy),$(".plus-icon").eq(1).css("display",""))},"json")},"json")}}function ye(){let e=location.pathname;if(we(),Ln(),qn(),Tt(),e.match(/\/alley\/fight\//))console.log("Alley fight"),fightForward();else if(e.match(/^(?!.*\/alley\/).*\/fight\//))console.log("Group fight"),An(),jn();else if(e==="/player/")he(),$("#stats-accordion .selected.active").css("cursor","pointer").on("click",Ne);else if(e==="/automobile/ride/")Le();else if(e==="/tattoo/")Tn();else if(e==="/neftlenin/")Rn();else if(e==="/square/tvtower/")Sn(),$("#breaking-news-normal")[0].scrollIntoView({behavior:"smooth",block:"start"});else if(e==="/metrowar/clan/"){let t=$(".clan-members > ul");$(".clan-members > ul li").sort((n,o)=>{let r=parseInt($(n).find(".cool-1").text().trim(),10);return parseInt($(o).find(".cool-1").text().trim(),10)-r}).appendTo(t)}else if(e==="/home/relic/")$("#relic-reinforced-list").css({marginBottom:"0px",scrollbarWidth:"none"}),$(".relic-reinforced-wnd").css({height:"auto"}),$(".relic-reinforced-wnd-list").css({height:"100%"});else if(e==="/travel2/")wt(),$("#content")[0].scrollIntoView({behavior:"smooth",block:"start"});else if(e==="/metro/")St(),$("#action-rat-fight > div.button-big.button, #timer-rat-fight > div:contains('\u041F\u0440\u043E\u043A\u0430\u0442\u0438\u0442\u044C\u0441\u044F')").on("click",function(){$(document).one("ajaxStop",St)});else if(e==="/petarena/")xt();else if(e==="/home/")Un();else if(e==="/camp/gypsy/"){let t=$(".game-types td:first");if($(".multi-play-gypsy").length||t.append(E({label:"\u041C\u043D\u0435 \u043F\u043E\u0432\u0435\u0437\u0435\u0442",action:async()=>await me(),className:"multi-play-gypsy"})),$(".multi-play-gypsy-flowers").length)return;let n=$(".game-types-col").first();console.log(n),n.append(E({label:"\u041C\u043D\u0435 \u043F\u043E\u0432\u0435\u0437\u0435\u0442",action:async()=>await me(),className:"multi-play-gypsy-flowers"}))}else if(e==="/casino/blackjack/"){if($(".blackjack-multi").length)return;let t=E({label:"\u0418\u0433\u0440\u0430\u0442\u044C \u0437\u0430 10",action:async()=>await nt(),className:"blackjack-multi"});$(".actions.bets").append(t)}else if(e==="/arbat/")Fn();else if(e==="/pyramid/")$("#pyramid-buy-form input").css({width:"70px"});else if(e.includes("clan")){if($("#reorder-clan").length)return;let t=$('<span id="reorder-clan" class="cool-1"><i></i></span>').css({cursor:"pointer"});t.on("click",dt);let n=_({text:"+\u0412\u0440\u0430\u0433\u0438",title:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0432 \u0441\u043F\u0438\u0441\u043E\u043A \u0432\u0440\u0430\u0433\u043E\u0432 (\u0434\u043B\u044F \u043A\u043B\u0430\u043D\u0432\u0430\u0440\u0430)",onClick:()=>ut(),className:"add-to-enemies",disableAfterClick:!0});$(n).css({display:"block",marginLeft:"auto"}),$('td.label:contains("\u041A\u043B\u0430\u043D\u0435\u0440\u044B")').append(n),t.insertAfter(`a[onclick="$('#players').toggle();"]`)}else["/squid/","/meetings/","/sovet/career/"].includes(e)&&$("#content")[0].scrollIntoView({behavior:"smooth",block:"start"})}var ve={heal:51,pyani:52,tvorog:53,vitaminsHealth:3397,pillsHealth:3840,deMinerale:3841,bomjori:3381,kukuruza:[9904,9905,9906,9907,9908,9909],pryaniki:[7375,7376,7377,7378,7379,7380],pasta:[3551,3552,3553,3554,3555,3556],caramels:[1209,1210,1211,1212,1213,1214],cocktails:[2656,2657,2658,2659,2660,2661],glupaya:2872};async function ze(e){let t=Array.isArray(e)?e:[e];return await Promise.all(t.map(async o=>(await w(`img[data-st="${o}"]`,"/player/"))?.getAttribute("data-id")))}async function Xe(e){let t=await ze(e);await Promise.all(t.map(n=>re(n)))}async function At(){await Xe(ve.heal)}async function re(e="2474213164"){let n=await(await fetch(`${new URL(window.location.href).origin}/player/json/use/${e}/`)).text(),{inventory:o}=JSON.parse(n);return o}async function Pn(e=!0){let{bomjori:t,kukuruza:n,pryaniki:o,pasta:r,caramels:a,pillsHealth:s,vitaminsHealth:c,glupaya:l}=ve,d=[...n,...a,...o,...r,s,c,t,e?l:null];await Promise.all(d.map(p=>Xe(p)))}async function F(){await fetch(new URL(window.location.href).origin+"/player/checkhp/",{headers:{accept:"*/*","accept-language":"en-GB,en;q=0.9","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrerPolicy:"strict-origin-when-cross-origin",body:"action=restorehp",method:"POST",mode:"cors",credentials:"include"})}async function Be(){let e=await ze(ve.glupaya);await re(e)}async function Ne(){let t=[...(await w(".stats",`/player/${player.id}/`))[0].querySelectorAll(".num")].map(o=>o.getAttribute("title")),n=Object.fromEntries(t.map(o=>{let[r,a]=o.split("||"),s=a.match(/Персонаж:\s*(\d+)/);return[r,s?Number(s[1]):null]}));return A({title:"\u{1F4CA} \u0412\u0430\u0448\u0438 \u0441\u0442\u0430\u0442\u044B",text:`<p>${Object.entries(n).map(([o,r])=>`${o}: ${r}`).join("</br>")}</p>`,img:"/css/images/loc/trainer.jpg"}),n}async function X(e=1){async function t(){await w("#workForm > div.time > span.error","/shaurburgers/")||await fetch(new URL(window.location.href).origin+"/shaurburgers/",{headers:{accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/shaurburgers/",referrerPolicy:"strict-origin-when-cross-origin",body:`action=work&time=${e}&__ajax=1&return_url=%2Fshaurburgers%2F`,method:"POST",mode:"cors",credentials:"include"})}let o=(await w("form.shaurburgers-work td#shaurma.value","/shaurburgers/"))?.getAttribute("timer");if(o){console.log(`\u23F1\uFE0F Shaurburgers work cooldown. Retry in ${S(o)}.`),setTimeout(async()=>await X(e),(o+5)*1e3);return}await t(e),setTimeout(async()=>X(e),60.05*60*1e3)}async function D(e=10){try{let t=$(await w("form#patrolForm","/alley/"));if(t.find(".timeleft").text()==="\u041D\u0430 \u0441\u0435\u0433\u043E\u0434\u043D\u044F \u0412\u044B \u0443\u0436\u0435 \u0438\u0441\u0442\u0440\u0430\u0442\u0438\u043B\u0438 \u0432\u0441\u0435 \u0432\u0440\u0435\u043C\u044F \u043F\u0430\u0442\u0440\u0443\u043B\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u044F."){let r=Math.floor((new Date(new Date().toLocaleString("en-US",{timeZone:"Europe/Moscow"})).setHours(24,1,0,0)-new Date)/1e3);return console.log(`\u23F0 Patrol is over. Retrying in ${S(r)}`),setTimeout(async()=>await D(e),r*1e3)}let o=t?.find("td.value")?.attr("timer");if(o){console.log(`\u23F1\uFE0F\u2744\uFE0F Patrol cooldown. Retry in ${S(o)}.`),setTimeout(async()=>await D(e),(+o+3)*1e3);return}console.log(`[\u{1F694}] Patrol Mode (${e} minutes).`),await Ct(e),setTimeout(()=>D(e),e*60*1e3+3e3)}catch(t){console.log(`Could not start patrol mode
`,t)}}async function In(){let e=await w('.bank-robbery input[name="fight"]',"/bank/")}async function Ct(e=10,t=1){await fetch(new URL(window.location.href).origin+"/alley/",{headers:{accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/alley/",referrerPolicy:"strict-origin-when-cross-origin",body:`action=patrol&region=${t}&time=${e}&__ajax=1&return_url=%2Falley%2F`,method:"POST",mode:"cors",credentials:"include"}),await fetch(new URL(window.location.href).origin+"/desert/"),await fetch(new URL(window.location.href).origin+"/desert/rob/")}async function Mn(){await fetch(new URL(window.location.href).origin+"/alley/",{headers:{accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/alley/",referrerPolicy:"strict-origin-when-cross-origin",body:"action=patriottv&time=1&__ajax=1&return_url=%2Falley%2F",method:"POST",mode:"cors",credentials:"include"})}function Si(){let e=AngryAjax.getCurrentUrl();return/^\/fight\/\d+\/?$/.test(e)}async function Ve(){try{let e=await W();if(e&&e>0){console.log(`[SMURF] Alley Cooldown ${S(e+5)}`),setTimeout(async()=>await Ve(),(e+5)*1e3);return}await F(),await smackMyBitchUp(),await Q({criteria:"type",minLvl:+player.level+4,maxLvl:+player.level+6}),e=await W(),console.log(`[SMURF] Attack again in ${S(e+5)}`),setTimeout(async()=>await Ve(),1e3*(e+5))}catch(e){console.log(`Could not handle smurf fight
`,e)}}async function Lt(e,t=0,...n){try{let o=document.querySelector("#personal > a.bubble > span > span.string"),r=o.querySelector("span.text").innerText;if(r==="\u0417\u0430\u0434\u0435\u0440\u0436\u0430\u043D \u0437\u0430 \u0431\u043E\u0438")console.log("\u0417\u0430\u0434\u0435\u0440\u0436\u0430\u043D \u0437\u0430 \u0431\u043E\u0438. \u041D\u0430\u043B\u0430\u0436\u0438\u0432\u0430\u044E \u0441\u0432\u044F\u0437\u0438..."),await fetch(new URL(window.location.href).origin+"/police/relations/"),AngryAjax.goToUrl("/alley/");else if(r==="\u041E\u0436\u0438\u0434\u0430\u043D\u0438\u0435 \u0431\u043E\u044F")try{let a=+o.querySelector("span.timeleft").getAttribute("timer");return console.log(r,`
\u041F\u0440\u043E\u0431\u0443\u044E \u0437\u0430\u043D\u043E\u0432\u043E \u0447\u0435\u0440\u0435\u0437: `,a),setTimeout(()=>e(...n),(a+t)*1e3),!0}catch(a){return console.log(`Waiting for fight. Time unknown... skipping...
`,a),!1}}catch{return console.log(`[\u2705] All checks passed.
`),!1}}async function Ut(e,t=0,n={}){if(await Me())return console.log("\u{1F6A8} \u0418\u0434\u0435\u0442 \u0433\u0440\u0443\u043F\u043F\u043E\u0432\u043E\u0439 \u0431\u043E\u0439, \u043F\u0440\u043E\u0431\u0443\u044E \u0437\u0430\u043D\u043E\u0432\u043E \u0447\u0435\u0440\u0435\u0437 \u043C\u0438\u043D\u0443\u0442\u0443..."),setTimeout(()=>{AngryAjax.goToUrl("/alley/"),e(n)},(60+t)*1e3),!0;let r=await W();return r?(console.log(`\u23F1\uFE0F \u041A\u0443\u043B\u0434\u0430\u0443\u043D \u0432 \u0437\u0430\u043A\u043E\u0443\u043B\u043A\u0430\u0445. \u041F\u0440\u043E\u0431\u0443\u044E \u0447\u0435\u0440\u0435\u0437 ${S(r)}.`),setTimeout(()=>e(n),(r+t)*1e3),!0):!1}async function We(){if(await ke(We))return;console.log("\u{1F37C} Searching for victims...");let t=await(await fetch(new URL(window.location.href).origin+"/alley/search/type/",{headers:{accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/alley/search/type/",referrerPolicy:"strict-origin-when-cross-origin",body:"type=victim&werewolf=0&nowerewolf=1&__ajax=1&return_url=%2Falley%2F",method:"POST",mode:"cors",credentials:"include"})).text(),{content:n}=JSON.parse(t),o=B(n),r=te(o);if(!r)return console.log("\u{1F50E} Could not find victim.");console.log("\u{1F50E} Found victim:",r);let a=await Ze(r);return a&&(console.log("\u2705 Fight completed. ",a),await Ft(a)),setTimeout(()=>We(),5.1*60*1e3)}async function $e(e=5){if(await ke($e))return;let n=await(await fetch(new URL(window.location.href).origin+"/alley/search/type/",{headers:{accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/alley/search/type/",referrerPolicy:"strict-origin-when-cross-origin",body:"type=enemy&werewolf=0&__ajax=1&return_url=%2Falley%2F",method:"POST",mode:"cors",credentials:"include"})).text(),{content:o}=JSON.parse(n),r=B(o),a=te(r);if(!a)return console.log("\u{1F50E} Could not find enemy, searching again in 1 minute..."),setTimeout(()=>$e(),60*1e3);console.log("\u{1F94A} Found enemy, attacking:",a),await Ze(a)&&(console.log("\u2705 Fight completed. Searching again in 5 minutes."),setTimeout(()=>$e(),e*60*1e3))}function Bn(e,t=10){let n=[...e.querySelectorAll(".fighter2-cell .stats > .stat span.num")].slice(0,-1).map(r=>+r.innerText).reduce((r,a)=>r+a,0);return[...e.querySelectorAll(".fighter1-cell .stats > .stat span.num")].slice(0,-1).map(r=>+r.innerText).reduce((r,a)=>r+a,0)-n<t?(console.log("Opponent too strong, looking for another opponent."),!1):!0}async function Ft(e){let n=await(await fetch(new URL(window.location.href).origin+"/fight/"+e)).text(),r=new DOMParser().parseFromString(n,"text/html");try{let a=+r.querySelector(".result .tugriki").innerText.split(",").join(""),s=r.querySelector(".fighter2 .user a").innerHTML.slice(1);if(console.log(`\u{1F50E} Loot: ${a} \u{1F4B5} from opponent: ${s} `),a<2e5){let c=r.querySelector(".fighter2 .user a").innerHTML.slice(1),l=te(r);await ct(c,l)}else a>3e5&&await de(s,"victim");return e}catch(a){console.log("Fight not found",a)}return!1}async function V(){try{let t=(await w("#content > div > table > tbody > tr > td:nth-child(1) > div > div > div.change-area > div.exchange > div.get > div > div > img","/factory/build/bronevik/")).getAttribute("alt"),o=+(await w("#content > div > table > tbody > tr > td:nth-child(1) > div > div > div.change-area > div.cooldown-wrapper > span.cooldown","/factory/build/bronevik/")).getAttribute("endtime");if(["\u043A\u0440\u0430\u0441\u043D\u044B\u0439 \u0441\u0442\u044F\u0433","\u0434\u0443\u0445 \u0440\u0435\u0432\u043E\u043B\u044E\u0446\u0438\u0438","\u0433\u0443\u0441\u0435\u043D\u0438\u0446\u044B","\u043D\u0430\u043A\u043B\u0435\u0439\u043A\u0438 \u0441 \u043B\u043E\u0437\u0443\u043D\u0433\u0430\u043C\u0438","\u0441\u0442\u0430\u043D\u043A\u043E\u0432\u044B\u0439 \u043F\u0443\u043B\u0435\u043C\u0435\u0442"].includes(t.toLowerCase()))return showAlert("\u{1F6A9} \u0411\u0440\u043E\u043D\u0435\u043F\u043E\u0435\u0437\u0434 \u0420\u0435\u0432\u043E\u043B\u044E\u0446\u0438\u0438",` \u041F\u043E\u043A\u0443\u043F\u0430\u044E \u0434\u0435\u0442\u0430\u043B\u044C! (${t} \u2705)
\u041F\u0440\u043E\u0431\u0443\u044E \u0437\u0430\u043D\u043E\u0432\u043E \u0447\u0435\u0440\u0435\u0437 10 \u043C\u0438\u043D\u0443\u0442.`),await fetch(new URL(window.location.href).origin+"/factory/exchange/",{headers:{accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/factory/build/bronevik/",referrerPolicy:"strict-origin-when-cross-origin",body:"action=exchange&code=bronevik&__referrer=%2Ffactory%2Fbuild%2Fbronevik%2F&return_url=%2Ffactory%2Fbuild%2Fbronevik%2F",method:"POST",mode:"cors",credentials:"include"}),setTimeout(V,2e3);let a=o*1e3-Date.now()+3e3;a&&a>0?(showAlert("\u{1F6A9} \u0411\u0440\u043E\u043D\u0435\u043F\u043E\u0435\u0437\u0434 \u0420\u0435\u0432\u043E\u043B\u044E\u0446\u0438\u0438",` \u041D\u0435 \u043D\u0430\u0448\u0435\u043B \u043D\u0443\u0436\u043D\u0443\u044E \u0434\u0435\u0442\u0430\u043B\u044C. (\u043F\u0440\u043E\u043F\u0443\u0441\u043A\u0430\u044E ${t})
\u041F\u0440\u043E\u0431\u0443\u044E \u0437\u0430\u043D\u043E\u0432\u043E \u0447\u0435\u0440\u0435\u0437 ${S(Math.floor(a/1e3))}.`),setTimeout(V,a)):await V()}catch(e){showAlert("\u041E\u0448\u0438\u0431\u043A\u0430!",`[\u{1F6A9}] \u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u043D\u0430\u0439\u0442\u0438 \u0434\u0435\u0442\u0430\u043B\u044C.
 \u0421\u043C\u043E\u0442\u0440\u0438 \u043A\u043E\u043D\u0441\u043E\u043B\u044C.`),console.log(`[\u{1F6A9}] Could not find Bronik piece.
`,e),setTimeout(V(),1e3)}}async function Ye(){return!!await w("#content > table.layout > tbody > tr > td.slots-cell > ul > li.avatar.avatar-back-12 > div.icons-place > a > i","player/")}async function Ke({intervalMinutes:e,minLvl:t,maxLvl:n,criteria:o}){if(await Ye()){console.log("\u{1F6A8} You have an injury. Skipping fight mode.");return}await F(),console.log(`[\u{1F94A}] Fight mode started.
Searching by level (${t}-${n})`);try{await Q({minLvl:t,maxLvl:n})}catch{console.log("\u{1F6A7} Could not find opponent. Retrying in 1 minute..."),setTimeout(()=>Ke({intervalMinutes:e,minLvl:t,maxLvl:n,criteria:o}),60*1e3)}setTimeout(()=>Ke({intervalMinutes:e,minLvl:t,maxLvl:n,criteria:o}),e*60*1e3)}async function N(e=5){try{if(await Ye()){console.log("\u{1F6A8} You have an injury. Skipping rat mode.");return}if(await Lt(N,e)){console.log("\u{1F6A8} You are busy. Skipping rat mode.");return}let o=await w("#content-no-rat > tbody > tr > td:nth-child(1) > div:nth-child(1) > div > div > p.holders > small","/metro/");if(o){let s=+o.getAttribute("timer");return console.log(`\u{1F400} Rat over. Retrying in ${S(s)}.`),setTimeout(()=>N(e),(s+2)*1e3)}if(AngryAjax.getCurrentUrl().includes("fight")){let s=setInterval(groupFightMakeStep,500);setTimeout(()=>clearInterval(s),4e3)}let r=await W();if(r){console.log(`[\u{1F400} Track Rat] \u2744\uFE0F Alley Cooldown.
 Retrying in ${S(r)}`),setTimeout(()=>N(),r*1e3);return}let a=(await w("#timer-rat-fight .value","/metro/"))?.getAttribute("timer");if(a&&+a>0){let s=+a;return console.log(`[\u{1F400} Track Rat] Rat Cooldown.
Retrying in ${S(s)}.`),setTimeout(()=>N(),s*1e3)}console.log("[\u{1F400} Track Rat] ATTACK!!1"),await F(),await Rt(),setTimeout(()=>N(),e*60*1e3)}catch(t){console.log(`[\u{1F400} Track Rat] Could not find rat.
`,t)}}async function Rt(){await F(),await fetch(new URL(window.location.href).origin+"/metro/track-rat/",{headers:{accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/metro/",referrerPolicy:"strict-origin-when-cross-origin",body:"__referrer=%2Fmetro%2F&return_url=%2Fmetro%2F",method:"POST",mode:"cors",credentials:"include"}),await O(.5),await fetch(new URL(window.location.href).origin+"/metro/fight-rat/",{headers:{accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/metro/",referrerPolicy:"strict-origin-when-cross-origin",body:"__referrer=%2Fmetro%2F&return_url=%2Fmetro%2F",method:"POST",mode:"cors",credentials:"include"}),await AngryAjax.goToUrl("/metro")}async function jt(e="work"){await fetch(new URL(window.location.href).origin+"/metro/",{headers:{accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","x-requested-with":"XMLHttpRequest"},body:`action=${e}&__referrer=%2Fmetro%2F&return_url=%2Fmetro%2F`,method:"POST",mode:"cors",credentials:"include"})}async function Nn(){await fetch(new URL(window.location.href).origin+"/alley/attack-npc/1/",{headers:{accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","x-requested-with":"XMLHttpRequest"},body:`player=${player.id}&__referrer=%2Fmetro%2F&return_url=%2Fmetro%2F`,method:"POST",mode:"cors",credentials:"include"})}async function ie(){let t=(await w("#kopaem .process td#metrodig","/metro/"))?.getAttribute("timer");if(t){console.log(`[\u26CF\uFE0F Metro] Metro work cooldown. Retry in ${S(+t)}.`),A({title:"\u0423\u0436\u0435 \u0432 \u043C\u0435\u0442\u0440\u043E \u26CF\uFE0F",img:"/@/images/pers/npc1_thumb.png",text:`\u0421\u043B\u0435\u0434\u0443\u044E\u0449\u0438\u0439 \u0441\u043F\u0443\u0441\u043A \u0447\u0435\u0440\u0435\u0437 ${S(+t)}.`}),setTimeout(async()=>await ie(),(+t+3)*1e3);return}A({title:"\u041A\u043E\u043F\u0430\u0435\u043C \u0432\u0435\u0442\u043A\u0443 \u043C\u0435\u0442\u0440\u043E \u26CF\uFE0F",img:"/@/images/pers/npc1_thumb.png",text:"\u0421\u043B\u0435\u0434\u0443\u044E\u0449\u0438\u0439 \u0441\u043F\u0443\u0441\u043A \u0447\u0435\u0440\u0435\u0437 10:00."}),await Nn(),await jt("dig"),await jt("work"),setTimeout(async()=>{await ie()},10.1*60*1e3)}async function Q({minLvl=+player.level-1,maxLvl=+player.level-1,criteria="level",performChecks=!0,werewolf=0}={}){if(performChecks&&await Ut(Q,0,{minLvl,maxLvl,criteria,performChecks,werewolf}))return;let attackPayload={level:`werewolf=${Number(werewolf)}&nowerewolf=${+!werewolf}&minlevel=${minLvl}&maxlevel=${maxLvl}&__ajax=1&return_url=%2Falley%2F`,type:`type=weak&=${Number(werewolf)}=${Number(werewolf)}&nowerewolf=${+!werewolf}&__ajax=1&return_url=%2Falley%2F`},res=await fetch(`${new URL(window.location.href).origin}/alley/search/${criteria}/`,{headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-ch-ua":'"Chromium";v="131", "Not_A Brand";v="24"',"sec-fetch-mode":"cors","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/alley/search/level/",referrerPolicy:"strict-origin-when-cross-origin",body:attackPayload[criteria],method:"POST",mode:"cors",credentials:"include"}),data=await res.text(),htmlStr=await JSON.parse(data).content,doc=B(htmlStr);console.log(criteria,attackPayload[criteria]);let opponentName=doc.querySelector(".fighter2")?.innerText;if(!opponentName)return!1;let opponentLevel=+doc.querySelector(".fighter2 .level")?.innerText.slice(1,-1),onclick=doc.querySelector("#content > div > div.button.button-fight > a")?.getAttribute("onclick");if(criteria==="type"&&(opponentLevel<minLvl||opponentLevel>maxLvl)){console.log("Opponent:",opponentName,opponentLevel,`
Level is too high or too low (${minLvl}-${maxLvl}). Retrying...`),await Q({minLvl,maxLvl,criteria,performChecks,werewolf});return}console.log("\u{1F94A} Found enemy, attacking:",opponentName),eval(onclick.split(";")[0])}async function Oe(e=25){for(let t=0;t<e;t++){await be();let n=+player.level==24?+player.level:+player.level-2;await Q({minLvl:n,maxLvl:n,criteria:"level",performChecks:!1,werewolf:!0}),await O(.2),A({title:"\u0412\u0441\u0451 \u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u043E \u0441\u0434\u0435\u043B\u0430\u043B!",text:"\u0411\u043E\u0439 \u2116"+(t+1)+" \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D.",img:"/@/images/pers/npc2.png"})}}async function be(){if(player.energy>=32){console.log("Using tonus instead of snickers"),cooldownReset("tonus");return}await fetch(new URL(window.location.href).origin+"/alley/",{headers:{accept:"application/json, text/javascript, */*; q=0.01","accept-language":"en-GB,en;q=0.9","content-type":"application/x-www-form-urlencoded; charset=UTF-8","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/alley/",referrerPolicy:"strict-origin-when-cross-origin",body:"action=rest_cooldown&code=snikers&ajax=true",method:"POST",mode:"cors",credentials:"include"})}async function On(){if(player.energy>=32){console.log("Using tonus instead of snickers"),cooldownReset("tonus");return}else jobShowTonusAlert()}async function Ze(e,t=!1){let o=await(await fetch(new URL(window.location.href).origin+"/alley/",{headers:{accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/alley/search/type/",referrerPolicy:"strict-origin-when-cross-origin",body:`action=attack&player=${e}&werewolf=${t?1:0}&useitems=0&__referrer=%2Falley%2Fsearch%2Ftype%2F&return_url=%2Falley%2Fsearch%2Ftype%2F`,method:"POST",mode:"cors",credentials:"include"})).json();return o.return_url&&o.return_url.includes("alley/fight/")?new URL(window.location.href).origin+""+o.return_url:null}async function W(){try{let t=(await w("#alley-search-myself span.timer","/alley/")).getAttribute("timer");return+t<0?!1:+t}catch{return console.log("\u{1F6A7} Could not find cooldown"),!1}}async function Je(){await F(),AngryAjax.reload(),await fetch(new URL(window.location.href).origin+"/fight/",{headers:{accept:"*/*","accept-language":"en-GB,en;q=0.9","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/fight/",referrerPolicy:"strict-origin-when-cross-origin",body:"action=join+fight&fight=0&price=money&type=chaotic&__ajax=1&return_url=%2Falley%2F",method:"POST",mode:"cors",credentials:"include"}),await fetch(new URL(window.location.href).origin+"/fight/",{headers:{accept:"*/*","accept-language":"en-GB,en;q=0.9","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/fight/",referrerPolicy:"strict-origin-when-cross-origin",body:"action=join+fight&fight=0&price=huntbadge&type=chaotic&__ajax=1&return_url=%2Falley%2F",method:"POST",mode:"cors",credentials:"include"}),await fetch(new URL(window.location.href).origin+"/fight/",{headers:{accept:"*/*","accept-language":"en-GB,en;q=0.9","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/fight/",referrerPolicy:"strict-origin-when-cross-origin",body:"action=join+fight&fight=0&price=zub&type=chaotic&__ajax=1&return_url=%2Falley%2F",method:"POST",mode:"cors",credentials:"include"}),AngryAjax.reload()}async function Ee(){function e(){let n=new Date,o={timeZone:"Europe/Moscow",hour12:!1},r=new Intl.DateTimeFormat("en-US",{...o,hour:"2-digit",minute:"2-digit"}).format(n),[a,s]=r.split(":").map(Number),c=a*60+s;return c>=690&&c<=1411}if(!e())return;console.log("[\u{1F93A}] Chaotic fight mode. Waiting for the next scheduled fight...");async function t(){let n=new Date,o=n.getMinutes(),r=[14,29,44,59].find(d=>o<d),a=r===void 0?n.getHours()+1:n.getHours(),s=r!==void 0?r:14,c=new Date(n.getFullYear(),n.getMonth(),n.getDate(),a,s,30),l=c.getTime()-n.getTime();showAlert("\u0412\u0441\u0451 \u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u043E \u0441\u0434\u0435\u043B\u0430\u043B!",`\u0417\u0430\u043F\u0438\u0441\u044C \u043D\u0430 \u0445\u0430\u043E\u0442 \u0432 ${c.toUTCString()} (\u0447\u0435\u0440\u0435\u0437 ${S(Math.floor(l/1e3))})`),l>0?setTimeout(async()=>{await Je(),setTimeout(async()=>await t(),60*1e3)},l):(await Je(),setTimeout(async()=>await t(),60*1e3))}t()}async function Ue(e=10){if(AngryAjax.getCurrentUrl().includes("fight"))for(let t=0;t<e;t++){let n=document.querySelector("#fight-actions > div.waiting");if(n){console.log(n);return}console.log("\u041F\u0440\u043E\u043F\u0443\u0441\u043A\u0430\u044E \u0445\u043E\u0434..."),groupFightMakeStep(),AngryAjax.reload(),await O(.5)}}async function xe(){let e=[11,15,19,23],t=K(),n=t.getHours(),o=e.find(c=>c>n)||e[0];o===e[0]&&n>e[e.length-1]&&(o=e[0]);let r=K();o<=n&&r.setDate(r.getDate()+1);let a=player.nickname==="Toni Kroos"?58:57;r.setHours(o-1,59,a,0);let s=r.getTime()-t.getTime();A({title:"\u0412\u0441\u0451 \u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u043E \u0441\u0434\u0435\u043B\u0430\u043B!",text:`\u0417\u0430\u043F\u0438\u0441\u044B\u0432\u0430\u044E\u0441\u044C \u043D\u0430 \u0418\u0418 \u0447\u0435\u0440\u0435\u0437 ${S(s/1e3)}.<br><i>(\u0432 ${r.toLocaleTimeString("ru-RU")})</i>`,img:"/@/images/pers/man131_thumb.png"}),setTimeout(async()=>await qt(),s),setTimeout(async()=>{await xe()},s+20*1e3)}async function qt(){await F(),await fetch(new URL(window.location.href).origin+"/phone/call/joinPhoneBoss/",{headers:{accept:"application/json, text/javascript, */*; q=0.01","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-ch-ua":'"Not A(Brand";v="8", "Chromium";v="132"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},body:"ajax=1&slot=phone3&type=phoneboss3",method:"POST",mode:"cors",credentials:"include"})}async function De(){let e=[12,16,20,24],t=K(),n=t.getHours(),o=e.find(s=>s>n)||e[0];o===e[0]&&n>e[e.length-1]&&(o=e[0]);let r=K();o<=n&&r.setDate(r.getDate()+1),r.setHours(o-1,50,0,0);let a=r.getTime()-t.getTime();A({title:"\u0412\u0441\u0451 \u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u043E \u0441\u0434\u0435\u043B\u0430\u043B!",img:"/@/images/pers/npc_dps_thumb.png",text:`\u0417\u0430\u043F\u0438\u0441\u044B\u0432\u0430\u044E\u0441\u044C \u043D\u0430 \u0414\u044D\u043F\u0441\u0430 \u0447\u0435\u0440\u0435\u0437 ${S(a/1e3)}.<br> <i>(\u0432 ${r.toLocaleTimeString("ru-RU")})</i>`}),setTimeout(async()=>await Pt(),a)}async function Pt(){await F(),await fetch(new URL(window.location.href).origin+"/phone/call/joinPhoneBoss/",{headers:{accept:"application/json, text/javascript, */*; q=0.01","content-type":"application/x-www-form-urlencoded; charset=UTF-8","x-requested-with":"XMLHttpRequest"},body:"ajax=1&slot=phone2&type=phoneboss2",method:"POST",mode:"cors",credentials:"include"})}async function He(){await fetch(new URL(window.location.href).origin+"/phone/call/joinPhoneBoss/",{headers:{accept:"application/json, text/javascript, */*; q=0.01","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-ch-ua":'"Not A(Brand";v="8", "Chromium";v="132"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},body:"ajax=1&slot=phone1&type=phoneboss1",method:"POST",mode:"cors",credentials:"include"}),AngryAjax.goToUrl("/alley/")}async function En(){let e=await w("#divSignInCampBattle ","camp/gypsy/");if(!e)return showAlert("\u0411\u043E\u0439 \u0441 \u0412\u043E\u0436\u0434\u0435\u043C. \u2604\uFE0F","\u041D\u0435\u0442\u0443 \u0431\u043E\u044F \u0432 \u0434\u0430\u043D\u043D\u044B\u0439 \u043C\u043E\u043C\u0435\u043D\u0442. \u041F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u043F\u043E\u0437\u0436\u0435."),!1;console.log(e),$.post("/camp/gypsy/",{action:"gypsyJoinFight"},function(t){t.return_url&&(document.location.href=t.return_url),Gypsy.showError(t)||Gypsy.renderBattleState(t.battle)},"json")}async function me(){await fetch(new URL(window.location.href).origin+"/camp/gypsy/",{headers:{accept:"application/json, text/javascript, */*; q=0.01","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/camp/gypsy/",body:"action=gypsyStart&gametype=0",method:"POST",mode:"cors",credentials:"include"}),await fetch(new URL(window.location.href).origin+"/camp/gypsy/",{headers:{accept:"application/json, text/javascript, */*; q=0.01","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/camp/gypsy/",body:"action=gypsyAuto",method:"POST",mode:"cors"}),AngryAjax.goToUrl("/camp/gypsy/")}function Dn(e,t){return e=e.toLowerCase(),Object.values(t).filter(n=>n.name.toLowerCase().includes(e))}function Hn(e){return Object.values(e).map(t=>({expiryDate:t[0],count:Number(t[1]),itemId:t[3]}))}async function Gn(e){await fetch(new URL(window.location.href).origin+"/phone/call/tradeItemView/",{headers:{accept:"application/json, text/javascript, */*; q=0.01","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-ch-ua":'"Not:A-Brand";v="24", "Chromium";v="134"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},body:`ajax=1&item=${e}&slot=phone3`,method:"POST",mode:"cors",credentials:"include"});let n=await(await fetch(new URL(window.location.href).origin+"/phone/call/giveItem/",{headers:{accept:"application/json, text/javascript, */*; q=0.01","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/phone/call",referrerPolicy:"strict-origin-when-cross-origin",body:"ajax=1&slot=phone3",method:"POST",mode:"cors",credentials:"include"})).text(),{prize:o}=JSON.parse(n);return console.log(o),$(`<div class="prize-container">${o}</div>`)}async function Ge(){let e=await re(0),t=Dn("\u0441\u0438\u0440\u0438",e)[0],n=Hn(t.stackList);console.log(n);for(let o of n)for(let r=0;r<o.count;r++)await Gn(o.itemId)}var I=window.Moscowpoly,It=window.SteppedEase,ae=window.TweenLite;function Mt(){I.animateDices=function(e){var t=this,n=this.$dice1,o=this.$dice2;n.unbind("click"),o.unbind("click"),n.removeAttr("style"),n.css({"background-position":"0 0"}).show(0);var r=mt_rand(10,20),a=mt_rand(1,2)*r/1e3,s=ae.to(n,a,{backgroundPosition:-1*65*r+"px 0",ease:It.config(r),paused:!0,onComplete:function(){n.css("background-position","").removeClass("i-1 i-2 i-3 i-4 i-5 i-6").addClass("i-"+e[0]),a>=l&&t.onAnimateDicesComplete()}});o.removeAttr("style"),o.css("background-position","0 -65px").show(0);var c=mt_rand(10,20),l=mt_rand(1,2)*c/1e3,d=ae.to(o,l,{backgroundPosition:-1*65*c+"px -65px",ease:It.config(c),paused:!0,onComplete:function(){o.css("background-position","").removeClass("i-1 i-2 i-3 i-4 i-5 i-6").addClass("i-"+e[1]),a<l&&t.onAnimateDicesComplete()}}),p=I.dicePositions[mt_rand(0,I.dicePositions.length-1)];n.css(p);var h={ease:Power1.easeOut,paused:!0};for(var f in p)h[f]=mt_rand(90,350);var x=ae.to(n,a,h);o.css(p);var k={ease:Power1.easeOut,paused:!0};for(var f in p)k[f]=mt_rand(90,350),Math.abs(h[f]-k[f])<35&&(h[f]+=h[f]>k[f]?50:-50);var L=ae.to(o,l,k);s.play(),d.play(),x.play(),L.play()},I.animateFigureRoute=function(e){if(e.length==0){this.setInAction(!1),this.setCellActive(this.data.current),this.updateInfoHTML(),this.initState();return}var t=this,n=I.getFigurePositionByCell(e[0]);ae.to(this.$figure,.1,{top:n.top,left:n.left,ease:Linear.easeNone,paused:!1,onComplete:function(){e=e.splice(1,e.length-1),t.animateFigureRoute(e)}})},I.dropDices=function(){this.setInAction(!0);var e=this;postUrl("/home/moscowpoly_roll/",{action:"moscowpoly_roll",ajax:1},"post",function(t){if(e.lastMove=t,e.state=t.state,e.animateDices(t.rollResult),t.text_m){if(t.text_m?.text?.includes("\u0417\u0430 \u043F\u0440\u043E\u0445\u043E\u0436\u0434\u0435\u043D\u0438\u0435 \u043A\u043B\u0435\u0442\u043A\u0438 \u0441\u0442\u0430\u0440\u0442 \u0432\u044B \u043F\u043E\u043B\u0443\u0447\u0430\u0435\u0442\u0435:"))return;e.addAlert(t.text_m)}}),setTimeout(()=>{I.setInAction(!1),I.doActivate()},500)},I.doActivate=function(){if(!this.inAction){this.setInAction(!0);var e=this;postUrl("/home/moscowpoly_activate/",{action:"moscowpoly_activate",ajax:1},"post",function(t){e.state=t.state,e.setInAction(!1),t.text_m&&!t.text_m?.text?.includes("\u0411\u043E\u043D\u0443\u0441 \u0443\u0436\u0435 \u0430\u043A\u0442\u0438\u0432\u0438\u0440\u043E\u0432\u0430\u043D")&&e.addAlert(t.text_m),e.updateInfoHTML(),e.initState()})}},I.show=function(){var e=this;postUrl("/home/moscowpoly_state/",{action:"moscowpoly_state",ajax:1},"post",function(t){if(e.open(t),t.text_m&&e.addAlert(t.text_m),$(".moscowpoly-multi-btn").length)return;let n=E({label:"\u0411\u0440\u043E\u0441\u0438\u0442\u044C \u043A\u0443\u0431\u0438\u043A\u0438",action:()=>(I.dropDices(),new Promise(o=>setTimeout(o,1e3))),className:"moscowpoly-multi",disableAfterClick:!1});$(".moscowpoly-panel__td-center").append(n)})}}var zn=[{selector:"#content > div > div.boss-common-block > div.boss-common-bottom-panel > div > div > span.boss-common-active-from-value",url:new URL(window.location.href).origin+"/shaman/",imgSrc:"/@/images/loc/shaman/abil_6.png",targetHref:"/shaman/"},{selector:"#content > div > div > div.grumpy2019-bottom-panel > div.grumpy2019-available-block > span.grumpy2019-available-value",url:new URL(window.location.href).origin+"/grumpy/",imgSrc:"/@/images/loc/grumpy/abils/abil_1.png",targetHref:"/grumpy/"},{selector:"#spanMatrixTimer",url:new URL(window.location.href).origin+"/matrix/",imgSrc:"/@/images/obj/beast_ability/ability54.png",targetHref:"/matrix/"},{selector:".worldwar2025-available-value",url:new URL(window.location.href).origin+"/tariffs/",imgSrc:"/@/images/obj/gifts2025/may/box_worldwar.png",targetHref:"/tariffs/"},{selector:".carlson2025-available-value",url:new URL(window.location.href).origin+"/karlsson/",imgSrc:"/@/images/obj/gifts2025/may/box_carlson.png",targetHref:"/karlsson/"},{selector:"#content > div > div.rocket2023-block > div.rocket2023-available-block > span.rocket2023-available-value",url:new URL(window.location.href).origin+"/kosmodromx/",imgSrc:"/@/images/obj/gifts2023/may/abil_kosm_smoke.png",targetHref:"/kosmodromx/"},{selector:"TODO dyi selector",url:new URL(window.location.href).origin+"/kosmodromx/",imgSrc:"/@/images/loc/rocket/rocket.png",targetHref:"/kosmodromx/"},{selector:"#hawthorn-popup > div > div.hawthorn-popup__actions > div > span",url:new URL(window.location.href).origin+"/trainer/vip/",imgSrc:"/@/images/loc/vip/hawthorn_icon.png",targetHref:"/trainer/vip/hawthorn/"},{selector:"#content > table > tbody > tr > td:nth-child(2) > div.block-bordered-tattoo > p:nth-child(3) > span",url:new URL(window.location.href).origin+"/nightclub/",imgSrc:"/@/images/obj/8march6/tattoo_mach.png",targetHref:"/nightclub/"},{selector:"#dino-tab-content-2 > div.dinopark-dino-stats > div:last-child > div.dinopark-dino-stat__value > span",url:new URL(window.location.href).origin+"/dinopark/",imgSrc:"/@/images/loc/dinopark/dinoegg.png",targetHref:"/dinopark/"},{selector:"#content > div > div.pilaf-actions .pilaf-activate-button-inner2",url:new URL(window.location.href).origin+"/teahouse/",imgSrc:"/@/images/loc/pilaf/objs/obj_3.png",targetHref:"/teahouse/"},{selector:"#content > div > div.bender-content > div.bender-use > div > div > button",url:new URL(window.location.href).origin+"/badasrobot/",imgSrc:"/@/images/obj/gifts2017/futurama/bender/head.png",targetHref:"/badasrobot/"}];async function Xn({selector:e,url:t,imgSrc:n,targetHref:o,onclick:r}){if(!e||!t||!n){console.log("Could not fetch timer. Data missing.");return}let a=await w(e,new URL(t).pathname);o==="/dinopark/"&&(n=(await w(".dinopark-dino-pic__img","/dinopark/")).getAttribute("src"));let s=q(`<img style="width: 56px; height: 56px; cursor: pointer; ${o==="/shaman/"&&"transform: scale(1.4);transform-origin: center;"}" src=${n} />`);!a||a===null?a=q("<span>\u0413\u043E\u0442\u043E\u0432\u043E</span>"):a?.innerText==="\u0417\u0430\u0431\u0440\u0430\u0442\u044C \u043F\u043E\u0439\u043B\u043E!"?a.innerText="\u0413\u043E\u0442\u043E\u0432\u043E":countdown(a),a.style.cssText=Bt.hawthorn,a?.getAttribute("class")?.includes("button")&&$(a).css({lineHeight:"24px",padding:"3px 12px"}),o==="/badasrobot/"&&a.styles;let c=q("<div></div>");return c.style.cssText="display: flex; align-items: center; flex-direction: column;",c.appendChild(s),c.appendChild(a),o&&s.addEventListener("click",()=>AngryAjax.goToUrl(o)),r&&s.addEventListener("click",r),c}async function tt(){let e=async()=>{let o=(await Promise.all(zn.map(async s=>{try{return await Xn(s)}catch(c){return console.log("Error processing timer:",s,c),null}}))).filter(Boolean),r=q(`<div class="timers-container" style="${Bt.timersContainer}"></div>`);function a(){window.innerWidth<1330?r.style.display="none":r.style.display="grid"}window.addEventListener("resize",a),a(),r.replaceChildren(...o),document.querySelector(".main-block").appendChild(r)},t=q(`
      <div class="button" style="position: fixed; top: 32px; right: 8px;" id="timers-trigger"><span class="f"><i class="rl"></i><i class="bl"></i><i class="brc"></i><div class="c" style="padding: 1px 3px;">
      \u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u0422\u0430\u0439\u043C\u0435\u0440\u044B
      </div></span></div>
      `);t.addEventListener("click",()=>{e(),t.remove()}),document.querySelector(".main-block").appendChild(t)}var Bt={hawthorn:`
    text-align: center;
    margin: auto 4px;
    font-family: 'bloccregular'; 
    font-size: 16px; 
    color: #ffffff; 
    text-shadow: rgb(73, 73, 73) 2px 0px 0px, rgb(73, 73, 73) 1.75517px 0.958851px 0px, rgb(73, 73, 73) 1.0806px 1.68294px 0px, rgb(73, 73, 73) 0.141474px 1.99499px 0px, rgb(73, 73, 73) -0.832294px 1.81859px 0px, rgb(73, 73, 73) -1.60229px 1.19694px 0px, rgb(73, 73, 73) -1.97998px 0.28224px 0px, rgb(73, 73, 73) -1.87291px -0.701566px 0px, rgb(73, 73, 73) -1.30729px -1.5136px 0px, rgb(73, 73, 73) -0.421592px -1.95506px 0px, rgb(73, 73, 73) 0.567324px -1.91785px 0px, rgb(73, 73, 73) 1.41734px -1.41108px 0px, rgb(73, 73, 73) 1.92034px -0.558831px 0px;
  `,timersContainer:`
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 8px;
    min-width: 190px;
    position: fixed;
    top: 32px;
    right: 8px;
    font-size: 79%;
    font-family: Tahoma, Arial, sans-serif;
    line-height: 1.3;
    padding: 12px 6px;
    border-radius: 8px;
    background: rgba(0, 0, 0, 0.8);
    box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.3);
    border: none;
    min-width: 190px;
    `};async function Vn(e){let t=new DOMParser,n=e.replace(/\\&quot;/g,'"').replace(/\\"/g,'"');return t.parseFromString(n,"text/html")}async function Wn(e,t){let o=await(await fetch(t)).text(),a=(await Vn(o)).querySelectorAll(e);if(a.length!==0)return a.length===1?a[0]:Array.from(a)}async function Kn(){try{let[e,t]=await Wn(".zodiak-snake-participiants","/zodiac/");return+e.innerText.trim().slice(-1)}catch{console.log("\u2649\uFE0F \u041D\u0435 \u043D\u0430\u0448\u0435\u043B \u0431\u0438\u043B\u0435\u0442\u043E\u0432 \u0437\u043E\u0434\u0438\u0430\u043A\u0430.");return}}async function Jn(e=1){await fetch(new URL(window.location.href).origin+"/zodiac/",{headers:{accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/zodiac/",referrerPolicy:"strict-origin-when-cross-origin",body:`action=buy_ticket&value=${e}&__referrer=%2Fzodiac%2F&return_url=%2Fzodiac%2F`,method:"POST",mode:"cors",credentials:"include"})}async function se({count:e,intervalMin:t}={count:1,intervalMin:60}){let n=await Kn();if(n===void 0)return showAlert("\u041E\u0448\u0438\u0431\u043A\u0430","\u041D\u0435\u0442\u0443 \u0437\u043E\u0434\u0438\u0430\u043A\u0430.");n<1?(showAlert("\u0417\u043E\u0434\u0438\u0430\u043A \u2649\uFE0F",`\u041D\u0435 \u043D\u0430\u0448\u0435\u043B \u0431\u0438\u043B\u0435\u0442\u043E\u0432. \u041F\u043E\u043A\u0443\u043F\u0430\u044E ${e} \u0448\u0442.`),await Jn(1)):showAlert("\u0417\u043E\u0434\u0438\u0430\u043A \u2649\uFE0F",`\u041D\u0430\u0448\u0435\u043B ${n} \u0431\u0438\u043B\u0435\u0442 \u0437\u043E\u0434\u0438\u0430\u043A\u0430. \u0421\u043A\u0438\u043F...`),showAlert("\u0417\u043E\u0434\u0438\u0430\u043A \u2649\uFE0F",`\u041F\u0440\u043E\u0431\u0443\u044E \u0437\u0430\u043D\u043E\u0432\u043E \u0447\u0435\u0440\u0435\u0437 ${t} \u043C\u0438\u043D\u0443\u0442(\u044B).`),setTimeout(async()=>await se({count:e,intervalMin:t}),t*60*1e3)}var Nt=window.player,Qe=window.showAlert,Di=new URL(window.location.href).origin+"";var et={accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"};async function Yn(){let e=await fetch(new URL(window.location.href).origin+"/casino/",{headers:et,referrer:new URL(window.location.href).origin+"/casino/",referrerPolicy:"strict-origin-when-cross-origin",body:"action=ore&count=20",method:"POST",mode:"cors",credentials:"include"}),{success:t}=await e.json();return{success:t}}async function ke(e){let t=await W();return t?(Qe(`${e.name}`,`\u{1F6A7} Cooldown in effect. Retrying in ${t} seconds.`),setTimeout(e,(t+5)*1e3),!0):!1}async function Zn(e="196690061"){await fetch(`${new URL(window.location.href).origin}/player/json/withdraw/${e}/`,{headers:{accept:"application/json, text/javascript, */*; q=0.01","accept-language":"en-GB,en-US;q=0.9,en;q=0.8","if-modified-since":new Date().toUTCString(),"sec-ch-ua":'"Chromium";v="131", "Not_A Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":Nt.nickname==="barifan"?'"macOS"':'"Linux"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:new URL(window.location.href).origin+"/player/",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"})}async function Qn(){await H("1052323"),await X(),await D(),await N(),await se()}async function Ot(){$(document).ajaxStop(function(){location.pathname==="/quest/"&&goNextLevel()})}async function eo(){await Pe(),await Ie(),await he(),await tt(),we(),Mt(),fe(),ge(),ue(),ye(),console.log("\u2139\uFE0F Enhanced client-side functionality."),window.SMURF_MODE&&(console.log("SMURF MODE"),await Ot()),$(document).ajaxStop(ye)}return Xt(to);})();

window.utils_ = utils_;
utils_.init();
})();
//# sourceMappingURL=bundle.js.map
